{"ast":null,"code":"import _objectSpread from\"D:/PROYECTO DE TESIS A\\xD1O 2026/sistema-armas/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from\"react\";import{toast}from\"sonner\";import{Card,CardContent,CardHeader,CardTitle}from\"../../../shared/ui/card\";import{Button}from\"../../../shared/ui/button\";import{Badge}from\"../../../shared/ui/badge\";import{Input}from\"../../../shared/ui/input\";import{Label}from\"../../../shared/ui/label\";import{Switch}from\"../../../shared/ui/switch\";import{Dialog,DialogContent,DialogHeader,DialogTitle,DialogFooter}from\"../../../shared/ui/dialog\";import{Table,TableBody,TableCell,TableHead,TableHeader,TableRow}from\"../../../shared/ui/table\";import{Plus,RefreshCw,Pencil,Trash2,Shield,User,ChevronLeft,ChevronRight}from\"lucide-react\";import{useAuth}from\"../../../context/auth-context\";import{listUsers,createUser,updateUser,setUserRole,setUserEstado,deleteUser}from\"../../../api/users\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function isActive(u){var _u$estado;return((_u$estado=u.estado)!==null&&_u$estado!==void 0?_u$estado:1)===1;}// ✅ valida ObjectId (Mongo) 24 hex\nfunction isMongoObjectId(id){return /^[a-fA-F0-9]{24}$/.test(id);}// ✅ saca id aunque venga raro (por si backend devuelve {_id: {$oid:\"...\"}} en algún caso viejo)\nfunction getUserId(u){const raw=u===null||u===void 0?void 0:u._id;if(typeof raw===\"string\")return raw;if(raw&&typeof raw===\"object\"){// casos comunes\nif(typeof raw.$oid===\"string\")return raw.$oid;if(typeof raw.oid===\"string\")return raw.oid;}return\"\";}// ✅ convierte FastAPI detail (string | object | array) en texto\nfunction toErrorMessage(err){var _err$response,_err$response$data;const detail=err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail;if(!detail)return(err===null||err===void 0?void 0:err.message)||\"Error\";if(typeof detail===\"string\")return detail;if(Array.isArray(detail)){const first=detail[0];if(first!==null&&first!==void 0&&first.loc&&first!==null&&first!==void 0&&first.msg)return\"\".concat(String(first.loc.join(\".\")),\": \").concat(String(first.msg));return detail.map(x=>x!==null&&x!==void 0&&x.msg?String(x.msg):JSON.stringify(x)).join(\" | \");}if(typeof detail===\"object\"){if(detail!==null&&detail!==void 0&&detail.loc&&detail!==null&&detail!==void 0&&detail.msg)return\"\".concat(String(detail.loc.join(\".\")),\": \").concat(String(detail.msg));return JSON.stringify(detail);}return String(detail);}export function Users(){var _me$_id;const{user:me}=useAuth();const isAdmin=(me===null||me===void 0?void 0:me.role)===\"admin\";const myId=(_me$_id=me===null||me===void 0?void 0:me._id)!==null&&_me$_id!==void 0?_me$_id:\"\";const[loading,setLoading]=useState(true);const[items,setItems]=useState([]);const[search,setSearch]=useState(\"\");// dialog\nconst[open,setOpen]=useState(false);const[editing,setEditing]=useState(null);const[form,setForm]=useState({name:\"\",email:\"\",password:\"\",role:\"operator\"});// ✅ paginación\nconst pageSize=5;const[page,setPage]=useState(1);const resetForm=()=>{setForm({name:\"\",email:\"\",password:\"\",role:\"operator\"});setEditing(null);};async function refresh(){setLoading(true);try{const data=await listUsers(500);const arr=Array.isArray(data)?data:[];// normaliza ids por seguridad (evita undefined)\nconst normalized=arr.map(u=>_objectSpread(_objectSpread({},u),{},{_id:getUserId(u)||\"\"}));normalized.sort((a,b)=>{const ra=a.role===\"admin\"?0:1;const rb=b.role===\"admin\"?0:1;if(ra!==rb)return ra-rb;return String(a.email||\"\").localeCompare(String(b.email||\"\"));});setItems(normalized);setPage(1);// vuelve a la página 1 al refrescar\n}catch(e){var _e$response;console.error(e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:_e$response.status,e===null||e===void 0?void 0:e.message);toast.error(\"No se pudieron cargar los usuarios\");setItems([]);}finally{setLoading(false);}}useEffect(()=>{if(!isAdmin)return;refresh();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[isAdmin]);const filtered=useMemo(()=>{const q=search.trim().toLowerCase();if(!q)return items;return items.filter(u=>{return String(u.email||\"\").toLowerCase().includes(q)||String(u.name||\"\").toLowerCase().includes(q)||String(u.role||\"\").toLowerCase().includes(q)||String(u._id||\"\").toLowerCase().includes(q);});},[items,search]);// ✅ total páginas\nconst totalPages=Math.max(1,Math.ceil(filtered.length/pageSize));useEffect(()=>{setPage(p=>Math.min(p,totalPages));},[totalPages]);const pageData=useMemo(()=>{const start=(page-1)*pageSize;return filtered.slice(start,start+pageSize);},[filtered,page]);const canPrev=page>1;const canNext=page<totalPages;const goPrev=()=>setPage(p=>Math.max(1,p-1));const goNext=()=>setPage(p=>Math.min(totalPages,p+1));const stats=useMemo(()=>{const total=items.length;const admins=items.filter(u=>u.role===\"admin\").length;const active=items.filter(u=>isActive(u)).length;const inactive=total-active;return{total,admins,active,inactive};},[items]);const openCreate=()=>{resetForm();setOpen(true);};const openEdit=u=>{var _u$name,_u$email,_ref;setEditing(u);setForm({name:(_u$name=u.name)!==null&&_u$name!==void 0?_u$name:\"\",email:(_u$email=u.email)!==null&&_u$email!==void 0?_u$email:\"\",password:\"\",role:(_ref=u.role)!==null&&_ref!==void 0?_ref:\"operator\"});setOpen(true);};const submit=async e=>{e.preventDefault();const name=form.name.trim();const email=form.email.trim().toLowerCase();if(name.length<2)return toast.error(\"Nombre mínimo 2 caracteres\");const emailOk=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);if(!emailOk)return toast.error(\"Email inválido (ej: usuario@dominio.com)\");try{if(editing){const id=getUserId(editing);if(!id)return toast.error(\"ID inválido (no se puede editar)\");await updateUser(id,{name,email});if(form.role!==editing.role){await setUserRole(id,form.role);}toast.success(\"Usuario actualizado\");}else{if(!form.password||form.password.length<6){return toast.error(\"Password mínimo 6 caracteres\");}await createUser({name,email,password:form.password,role:form.role});toast.success(\"Usuario creado\");}setOpen(false);resetForm();await refresh();}catch(e){var _e$response2;console.error(e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:_e$response2.status,e===null||e===void 0?void 0:e.message);toast.error(toErrorMessage(e));}};const toggleEstado=async u=>{const id=getUserId(u);if(!id)return toast.error(\"ID inválido\");if(id===myId)return toast.error(\"No puedes desactivarte a ti mismo\");const next=isActive(u)?0:1;setItems(prev=>prev.map(x=>getUserId(x)===id?_objectSpread(_objectSpread({},x),{},{estado:next}):x));try{await setUserEstado(id,next);toast.success(next===1?\"Usuario activado\":\"Usuario desactivado\");}catch(e){toast.error(toErrorMessage(e));await refresh();}};const changeRole=async(u,role)=>{const id=getUserId(u);if(!id)return toast.error(\"ID inválido\");if(id===myId&&role!==\"admin\")return toast.error(\"No puedes quitarte el rol admin\");const prevRole=u.role;setItems(prev=>prev.map(x=>getUserId(x)===id?_objectSpread(_objectSpread({},x),{},{role}):x));try{await setUserRole(id,role);toast.success(\"Rol actualizado\");}catch(e){toast.error(toErrorMessage(e));setItems(prev=>prev.map(x=>getUserId(x)===id?_objectSpread(_objectSpread({},x),{},{role:prevRole}):x));}};const remove=async u=>{const id=getUserId(u);if(!id)return toast.error(\"ID inválido\");if(id===myId)return toast.error(\"No puedes eliminar tu propio usuario\");// ✅ si tu backend SOLO acepta ObjectId y este no lo es, te avisamos claro\nif(!isMongoObjectId(id)){return toast.error(\"No se puede eliminar: el ID no es ObjectId (24 caracteres).\");}if(!window.confirm(\"\\xBFEliminar usuario \\\"\".concat(u.email,\"\\\"?\")))return;const prev=items;setItems(p=>p.filter(x=>getUserId(x)!==id));try{await deleteUser(id);toast.success(\"Usuario eliminado\");await refresh();}catch(e){toast.error(toErrorMessage(e));setItems(prev);}};if(!isAdmin){return/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-4 rounded-lg border bg-muted/30 text-muted-foreground\",children:\"No tienes permisos para ver este m\\xF3dulo.\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-slate-900\",children:\"Usuarios\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-600\",children:\"Crear, editar, activar/desactivar y gestionar roles\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"outline\",onClick:refresh,children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"h-4 w-4 mr-2\"}),\"Refrescar\"]}),/*#__PURE__*/_jsxs(Button,{onClick:openCreate,children:[/*#__PURE__*/_jsx(Plus,{className:\"h-5 w-5 mr-2\"}),\"Crear Usuario\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-bold text-slate-500\",children:\"TOTAL\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:stats.total})]}),/*#__PURE__*/_jsx(User,{className:\"h-5 w-5 text-slate-500\"})]})}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-bold text-slate-500\",children:\"ADMINS\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:stats.admins})]}),/*#__PURE__*/_jsx(Shield,{className:\"h-5 w-5 text-indigo-600\"})]})}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-bold text-slate-500\",children:\"ACTIVOS\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:stats.active})]})}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-bold text-slate-500\",children:\"INACTIVOS\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:stats.inactive})]})})]}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4\",children:[/*#__PURE__*/_jsx(Label,{children:\"Buscar\"}),/*#__PURE__*/_jsx(Input,{value:search,onChange:e=>setSearch(e.target.value),placeholder:\"email, nombre, rol o id...\"})]})}),/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(CardHeader,{className:\"bg-slate-50/50 border-b\",children:/*#__PURE__*/_jsx(CardTitle,{className:\"text-sm\",children:\"Listado\"})}),/*#__PURE__*/_jsx(CardContent,{className:\"p-0\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"p-6 text-sm text-slate-500\",children:\"Cargando usuarios...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHeader,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableHead,{children:\"Usuario\"}),/*#__PURE__*/_jsx(TableHead,{children:\"Rol\"}),/*#__PURE__*/_jsx(TableHead,{className:\"text-center\",children:\"Estado\"}),/*#__PURE__*/_jsx(TableHead,{className:\"text-right\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[pageData.map(u=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-slate-900\",children:[u.name||\"—\",\" \",getUserId(u)===myId&&/*#__PURE__*/_jsx(Badge,{variant:\"outline\",className:\"ml-2 text-xs font-bold\",children:\"t\\xFA\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-slate-600 font-mono\",children:u.email})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Badge,{className:u.role===\"admin\"?\"bg-indigo-100 text-indigo-700\":\"bg-slate-100 text-slate-700\",children:String(u.role||\"\").toUpperCase()}),/*#__PURE__*/_jsxs(\"select\",{className:\"text-xs border rounded-md px-2 py-1 bg-white\",value:u.role,onChange:e=>changeRole(u,e.target.value),disabled:getUserId(u)===myId,children:[/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"operator\",children:\"operator\"})]})]})}),/*#__PURE__*/_jsx(TableCell,{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Switch,{checked:isActive(u),onCheckedChange:()=>toggleEstado(u),disabled:getUserId(u)===myId}),/*#__PURE__*/_jsx(Badge,{className:isActive(u)?\"bg-emerald-100 text-emerald-700\":\"bg-rose-100 text-rose-700\",children:isActive(u)?\"ACTIVO\":\"INACTIVO\"})]})}),/*#__PURE__*/_jsx(TableCell,{className:\"text-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex gap-2 justify-end\",children:[/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"outline\",onClick:()=>openEdit(u),children:/*#__PURE__*/_jsx(Pencil,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"outline\",className:\"text-rose-600\",onClick:()=>remove(u),disabled:getUserId(u)===myId,title:getUserId(u)===myId?\"No puedes eliminarte\":\"Eliminar\",children:/*#__PURE__*/_jsx(Trash2,{className:\"h-4 w-4\"})})]})})]},getUserId(u)||\"\".concat(u.email,\"-\").concat(Math.random()))),pageData.length===0&&/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:4,className:\"py-10 text-center text-sm text-slate-500\",children:\"No hay resultados.\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-t flex items-center justify-between bg-slate-50/30\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-slate-500\",children:[\"P\\xE1gina \",page,\" de \",totalPages,\" \\u2022 Mostrando \",pageData.length,\" de \",filtered.length]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:goPrev,disabled:!canPrev,children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:goNext,disabled:!canNext,children:/*#__PURE__*/_jsx(ChevronRight,{className:\"h-4 w-4\"})})]})]})]})})]}),/*#__PURE__*/_jsx(Dialog,{open:open,onOpenChange:setOpen,children:/*#__PURE__*/_jsxs(DialogContent,{className:\"sm:max-w-[520px]\",children:[/*#__PURE__*/_jsx(DialogHeader,{children:/*#__PURE__*/_jsxs(DialogTitle,{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(User,{className:\"h-5 w-5 text-blue-600\"}),editing?\"Editar Usuario\":\"Crear Usuario\"]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,className:\"space-y-4 pt-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{children:\"Nombre\"}),/*#__PURE__*/_jsx(Input,{value:form.name,onChange:e=>setForm(p=>_objectSpread(_objectSpread({},p),{},{name:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Input,{type:\"email\",value:form.email,onChange:e=>setForm(p=>_objectSpread(_objectSpread({},p),{},{email:e.target.value})),placeholder:\"usuario@dominio.com\",required:true})]}),!editing&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",value:form.password,onChange:e=>setForm(p=>_objectSpread(_objectSpread({},p),{},{password:e.target.value})),placeholder:\"m\\xEDnimo 6 caracteres\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{children:\"Rol\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full border rounded-md px-3 py-2 bg-white text-sm\",value:form.role,onChange:e=>setForm(p=>_objectSpread(_objectSpread({},p),{},{role:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"operator\",children:\"operator\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"admin\"})]})]}),/*#__PURE__*/_jsxs(DialogFooter,{className:\"pt-2\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:()=>{setOpen(false);resetForm();},children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:editing?\"Guardar cambios\":\"Crear\"})]})]})]})})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","toast","Card","CardContent","CardHeader","CardTitle","Button","Badge","Input","Label","Switch","Dialog","DialogContent","DialogHeader","DialogTitle","DialogFooter","Table","TableBody","TableCell","TableHead","TableHeader","TableRow","Plus","RefreshCw","Pencil","Trash2","Shield","User","ChevronLeft","ChevronRight","useAuth","listUsers","createUser","updateUser","setUserRole","setUserEstado","deleteUser","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","isActive","u","_u$estado","estado","isMongoObjectId","id","test","getUserId","raw","_id","$oid","oid","toErrorMessage","err","_err$response","_err$response$data","detail","response","data","message","Array","isArray","first","loc","msg","concat","String","join","map","x","JSON","stringify","Users","_me$_id","user","me","isAdmin","role","myId","loading","setLoading","items","setItems","search","setSearch","open","setOpen","editing","setEditing","form","setForm","name","email","password","pageSize","page","setPage","resetForm","refresh","arr","normalized","_objectSpread","sort","a","b","ra","rb","localeCompare","e","_e$response","console","error","status","filtered","q","trim","toLowerCase","filter","includes","totalPages","Math","max","ceil","length","p","min","pageData","start","slice","canPrev","canNext","goPrev","goNext","stats","total","admins","active","inactive","openCreate","openEdit","_u$name","_u$email","_ref","submit","preventDefault","emailOk","success","_e$response2","toggleEstado","next","prev","changeRole","prevRole","remove","window","confirm","className","children","variant","onClick","value","onChange","target","placeholder","toUpperCase","disabled","checked","onCheckedChange","size","title","random","colSpan","onOpenChange","onSubmit","required","type"],"sources":["D:/PROYECTO DE TESIS AÑO 2026/sistema-armas/frontend/src/modules/users/ui/Users.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../../shared/ui/card\";\r\nimport { Button } from \"../../../shared/ui/button\";\r\nimport { Badge } from \"../../../shared/ui/badge\";\r\nimport { Input } from \"../../../shared/ui/input\";\r\nimport { Label } from \"../../../shared/ui/label\";\r\nimport { Switch } from \"../../../shared/ui/switch\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from \"../../../shared/ui/dialog\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"../../../shared/ui/table\";\r\n\r\nimport { Plus, RefreshCw, Pencil, Trash2, Shield, User, ChevronLeft, ChevronRight } from \"lucide-react\";\r\n\r\nimport { useAuth } from \"../../../context/auth-context\";\r\nimport {\r\n  listUsers,\r\n  createUser,\r\n  updateUser,\r\n  setUserRole,\r\n  setUserEstado,\r\n  deleteUser,\r\n  type UserOut,\r\n} from \"../../../api/users\";\r\n\r\ntype Role = \"admin\" | \"operator\";\r\n\r\nfunction isActive(u: UserOut) {\r\n  return (u.estado ?? 1) === 1;\r\n}\r\n\r\n// ✅ valida ObjectId (Mongo) 24 hex\r\nfunction isMongoObjectId(id: string) {\r\n  return /^[a-fA-F0-9]{24}$/.test(id);\r\n}\r\n\r\n// ✅ saca id aunque venga raro (por si backend devuelve {_id: {$oid:\"...\"}} en algún caso viejo)\r\nfunction getUserId(u: any): string {\r\n  const raw = u?._id;\r\n  if (typeof raw === \"string\") return raw;\r\n  if (raw && typeof raw === \"object\") {\r\n    // casos comunes\r\n    if (typeof raw.$oid === \"string\") return raw.$oid;\r\n    if (typeof raw.oid === \"string\") return raw.oid;\r\n  }\r\n  return \"\";\r\n}\r\n\r\n// ✅ convierte FastAPI detail (string | object | array) en texto\r\nfunction toErrorMessage(err: any): string {\r\n  const detail = err?.response?.data?.detail;\r\n  if (!detail) return err?.message || \"Error\";\r\n\r\n  if (typeof detail === \"string\") return detail;\r\n\r\n  if (Array.isArray(detail)) {\r\n    const first = detail[0];\r\n    if (first?.loc && first?.msg) return `${String(first.loc.join(\".\"))}: ${String(first.msg)}`;\r\n    return detail.map((x) => (x?.msg ? String(x.msg) : JSON.stringify(x))).join(\" | \");\r\n  }\r\n\r\n  if (typeof detail === \"object\") {\r\n    if (detail?.loc && detail?.msg) return `${String(detail.loc.join(\".\"))}: ${String(detail.msg)}`;\r\n    return JSON.stringify(detail);\r\n  }\r\n\r\n  return String(detail);\r\n}\r\n\r\nexport function Users() {\r\n  const { user: me } = useAuth();\r\n  const isAdmin = me?.role === \"admin\";\r\n  const myId = me?._id ?? \"\";\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [items, setItems] = useState<UserOut[]>([]);\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  // dialog\r\n  const [open, setOpen] = useState(false);\r\n  const [editing, setEditing] = useState<UserOut | null>(null);\r\n\r\n  const [form, setForm] = useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    role: \"operator\" as Role,\r\n  });\r\n\r\n  // ✅ paginación\r\n  const pageSize = 5;\r\n  const [page, setPage] = useState(1);\r\n\r\n  const resetForm = () => {\r\n    setForm({ name: \"\", email: \"\", password: \"\", role: \"operator\" });\r\n    setEditing(null);\r\n  };\r\n\r\n  async function refresh() {\r\n    setLoading(true);\r\n    try {\r\n      const data = await listUsers(500);\r\n      const arr = Array.isArray(data) ? data : [];\r\n\r\n      // normaliza ids por seguridad (evita undefined)\r\n      const normalized = arr.map((u: any) => ({ ...u, _id: getUserId(u) || \"\" }));\r\n\r\n      normalized.sort((a, b) => {\r\n        const ra = a.role === \"admin\" ? 0 : 1;\r\n        const rb = b.role === \"admin\" ? 0 : 1;\r\n        if (ra !== rb) return ra - rb;\r\n        return String(a.email || \"\").localeCompare(String(b.email || \"\"));\r\n      });\r\n\r\n      setItems(normalized);\r\n      setPage(1); // vuelve a la página 1 al refrescar\r\n    } catch (e: any) {\r\n      console.error(e?.response?.status, e?.message);\r\n      toast.error(\"No se pudieron cargar los usuarios\");\r\n      setItems([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!isAdmin) return;\r\n    refresh();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isAdmin]);\r\n\r\n  const filtered = useMemo(() => {\r\n    const q = search.trim().toLowerCase();\r\n    if (!q) return items;\r\n    return items.filter((u: any) => {\r\n      return (\r\n        String(u.email || \"\").toLowerCase().includes(q) ||\r\n        String(u.name || \"\").toLowerCase().includes(q) ||\r\n        String(u.role || \"\").toLowerCase().includes(q) ||\r\n        String(u._id || \"\").toLowerCase().includes(q)\r\n      );\r\n    });\r\n  }, [items, search]);\r\n\r\n  // ✅ total páginas\r\n  const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));\r\n  useEffect(() => {\r\n    setPage((p) => Math.min(p, totalPages));\r\n  }, [totalPages]);\r\n\r\n  const pageData = useMemo(() => {\r\n    const start = (page - 1) * pageSize;\r\n    return filtered.slice(start, start + pageSize);\r\n  }, [filtered, page]);\r\n\r\n  const canPrev = page > 1;\r\n  const canNext = page < totalPages;\r\n  const goPrev = () => setPage((p) => Math.max(1, p - 1));\r\n  const goNext = () => setPage((p) => Math.min(totalPages, p + 1));\r\n\r\n  const stats = useMemo(() => {\r\n    const total = items.length;\r\n    const admins = items.filter((u) => u.role === \"admin\").length;\r\n    const active = items.filter((u) => isActive(u)).length;\r\n    const inactive = total - active;\r\n    return { total, admins, active, inactive };\r\n  }, [items]);\r\n\r\n  const openCreate = () => {\r\n    resetForm();\r\n    setOpen(true);\r\n  };\r\n\r\n  const openEdit = (u: UserOut) => {\r\n    setEditing(u);\r\n    setForm({\r\n      name: u.name ?? \"\",\r\n      email: u.email ?? \"\",\r\n      password: \"\",\r\n      role: (u.role as Role) ?? \"operator\",\r\n    });\r\n    setOpen(true);\r\n  };\r\n\r\n  const submit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    const name = form.name.trim();\r\n    const email = form.email.trim().toLowerCase();\r\n\r\n    if (name.length < 2) return toast.error(\"Nombre mínimo 2 caracteres\");\r\n\r\n    const emailOk = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\r\n    if (!emailOk) return toast.error(\"Email inválido (ej: usuario@dominio.com)\");\r\n\r\n    try {\r\n      if (editing) {\r\n        const id = getUserId(editing);\r\n        if (!id) return toast.error(\"ID inválido (no se puede editar)\");\r\n\r\n        await updateUser(id, { name, email });\r\n\r\n        if (form.role !== editing.role) {\r\n          await setUserRole(id, form.role);\r\n        }\r\n\r\n        toast.success(\"Usuario actualizado\");\r\n      } else {\r\n        if (!form.password || form.password.length < 6) {\r\n          return toast.error(\"Password mínimo 6 caracteres\");\r\n        }\r\n        await createUser({ name, email, password: form.password, role: form.role });\r\n        toast.success(\"Usuario creado\");\r\n      }\r\n\r\n      setOpen(false);\r\n      resetForm();\r\n      await refresh();\r\n    } catch (e: any) {\r\n      console.error(e?.response?.status, e?.message);\r\n      toast.error(toErrorMessage(e));\r\n    }\r\n  };\r\n\r\n  const toggleEstado = async (u: UserOut) => {\r\n    const id = getUserId(u);\r\n    if (!id) return toast.error(\"ID inválido\");\r\n    if (id === myId) return toast.error(\"No puedes desactivarte a ti mismo\");\r\n\r\n    const next: 0 | 1 = isActive(u) ? 0 : 1;\r\n\r\n    setItems((prev) => prev.map((x: any) => (getUserId(x) === id ? { ...x, estado: next } : x)));\r\n\r\n    try {\r\n      await setUserEstado(id, next);\r\n      toast.success(next === 1 ? \"Usuario activado\" : \"Usuario desactivado\");\r\n    } catch (e: any) {\r\n      toast.error(toErrorMessage(e));\r\n      await refresh();\r\n    }\r\n  };\r\n\r\n  const changeRole = async (u: UserOut, role: Role) => {\r\n    const id = getUserId(u);\r\n    if (!id) return toast.error(\"ID inválido\");\r\n    if (id === myId && role !== \"admin\") return toast.error(\"No puedes quitarte el rol admin\");\r\n\r\n    const prevRole = u.role;\r\n    setItems((prev) => prev.map((x: any) => (getUserId(x) === id ? { ...x, role } : x)));\r\n\r\n    try {\r\n      await setUserRole(id, role);\r\n      toast.success(\"Rol actualizado\");\r\n    } catch (e: any) {\r\n      toast.error(toErrorMessage(e));\r\n      setItems((prev) => prev.map((x: any) => (getUserId(x) === id ? { ...x, role: prevRole } : x)));\r\n    }\r\n  };\r\n\r\n  const remove = async (u: UserOut) => {\r\n    const id = getUserId(u);\r\n    if (!id) return toast.error(\"ID inválido\");\r\n    if (id === myId) return toast.error(\"No puedes eliminar tu propio usuario\");\r\n\r\n    // ✅ si tu backend SOLO acepta ObjectId y este no lo es, te avisamos claro\r\n    if (!isMongoObjectId(id)) {\r\n      return toast.error(\"No se puede eliminar: el ID no es ObjectId (24 caracteres).\");\r\n    }\r\n\r\n    if (!window.confirm(`¿Eliminar usuario \"${u.email}\"?`)) return;\r\n\r\n    const prev = items;\r\n    setItems((p) => p.filter((x: any) => getUserId(x) !== id));\r\n\r\n    try {\r\n      await deleteUser(id);\r\n      toast.success(\"Usuario eliminado\");\r\n      await refresh();\r\n    } catch (e: any) {\r\n      toast.error(toErrorMessage(e));\r\n      setItems(prev);\r\n    }\r\n  };\r\n\r\n  if (!isAdmin) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"p-4 rounded-lg border bg-muted/30 text-muted-foreground\">\r\n          No tienes permisos para ver este módulo.\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-5\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between gap-3\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-slate-900\">Usuarios</h1>\r\n          <p className=\"text-sm text-slate-600\">Crear, editar, activar/desactivar y gestionar roles</p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button variant=\"outline\" onClick={refresh}>\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Refrescar\r\n          </Button>\r\n          <Button onClick={openCreate}>\r\n            <Plus className=\"h-5 w-5 mr-2\" />\r\n            Crear Usuario\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"pt-4 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-xs font-bold text-slate-500\">TOTAL</p>\r\n              <p className=\"text-2xl font-bold\">{stats.total}</p>\r\n            </div>\r\n            <User className=\"h-5 w-5 text-slate-500\" />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"pt-4 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-xs font-bold text-slate-500\">ADMINS</p>\r\n              <p className=\"text-2xl font-bold\">{stats.admins}</p>\r\n            </div>\r\n            <Shield className=\"h-5 w-5 text-indigo-600\" />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"pt-4\">\r\n            <p className=\"text-xs font-bold text-slate-500\">ACTIVOS</p>\r\n            <p className=\"text-2xl font-bold\">{stats.active}</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"pt-4\">\r\n            <p className=\"text-xs font-bold text-slate-500\">INACTIVOS</p>\r\n            <p className=\"text-2xl font-bold\">{stats.inactive}</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <CardContent className=\"pt-4\">\r\n          <Label>Buscar</Label>\r\n          <Input\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            placeholder=\"email, nombre, rol o id...\"\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Table */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <CardHeader className=\"bg-slate-50/50 border-b\">\r\n          <CardTitle className=\"text-sm\">Listado</CardTitle>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-0\">\r\n          {loading ? (\r\n            <div className=\"p-6 text-sm text-slate-500\">Cargando usuarios...</div>\r\n          ) : (\r\n            <>\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Usuario</TableHead>\r\n                    <TableHead>Rol</TableHead>\r\n                    <TableHead className=\"text-center\">Estado</TableHead>\r\n                    <TableHead className=\"text-right\">Acciones</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n\r\n                <TableBody>\r\n                  {pageData.map((u: any) => (\r\n                    <TableRow key={getUserId(u) || `${u.email}-${Math.random()}`}>\r\n                      <TableCell>\r\n                        <div className=\"space-y-1\">\r\n                          <div className=\"font-semibold text-slate-900\">\r\n                            {u.name || \"—\"}{\" \"}\r\n                            {getUserId(u) === myId && (\r\n                              <Badge variant=\"outline\" className=\"ml-2 text-xs font-bold\">\r\n                                tú\r\n                              </Badge>\r\n                            )}\r\n                          </div>\r\n                          <div className=\"text-xs text-slate-600 font-mono\">{u.email}</div>\r\n                        </div>\r\n                      </TableCell>\r\n\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge\r\n                            className={\r\n                              u.role === \"admin\"\r\n                                ? \"bg-indigo-100 text-indigo-700\"\r\n                                : \"bg-slate-100 text-slate-700\"\r\n                            }\r\n                          >\r\n                            {String(u.role || \"\").toUpperCase()}\r\n                          </Badge>\r\n\r\n                          <select\r\n                            className=\"text-xs border rounded-md px-2 py-1 bg-white\"\r\n                            value={u.role}\r\n                            onChange={(e) => changeRole(u, e.target.value as Role)}\r\n                            disabled={getUserId(u) === myId}\r\n                          >\r\n                            <option value=\"admin\">admin</option>\r\n                            <option value=\"operator\">operator</option>\r\n                          </select>\r\n                        </div>\r\n                      </TableCell>\r\n\r\n                      <TableCell className=\"text-center\">\r\n                        <div className=\"inline-flex items-center gap-2\">\r\n                          <Switch\r\n                            checked={isActive(u)}\r\n                            onCheckedChange={() => toggleEstado(u)}\r\n                            disabled={getUserId(u) === myId}\r\n                          />\r\n                          <Badge\r\n                            className={\r\n                              isActive(u)\r\n                                ? \"bg-emerald-100 text-emerald-700\"\r\n                                : \"bg-rose-100 text-rose-700\"\r\n                            }\r\n                          >\r\n                            {isActive(u) ? \"ACTIVO\" : \"INACTIVO\"}\r\n                          </Badge>\r\n                        </div>\r\n                      </TableCell>\r\n\r\n                      <TableCell className=\"text-right\">\r\n                        <div className=\"inline-flex gap-2 justify-end\">\r\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => openEdit(u)}>\r\n                            <Pencil className=\"h-4 w-4\" />\r\n                          </Button>\r\n\r\n                          <Button\r\n                            size=\"sm\"\r\n                            variant=\"outline\"\r\n                            className=\"text-rose-600\"\r\n                            onClick={() => remove(u)}\r\n                            disabled={getUserId(u) === myId}\r\n                            title={getUserId(u) === myId ? \"No puedes eliminarte\" : \"Eliminar\"}\r\n                          >\r\n                            <Trash2 className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n\r\n                  {pageData.length === 0 && (\r\n                    <TableRow>\r\n                      <TableCell colSpan={4} className=\"py-10 text-center text-sm text-slate-500\">\r\n                        No hay resultados.\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  )}\r\n                </TableBody>\r\n              </Table>\r\n\r\n              {/* ✅ Paginación */}\r\n              <div className=\"p-4 border-t flex items-center justify-between bg-slate-50/30\">\r\n                <span className=\"text-xs text-slate-500\">\r\n                  Página {page} de {totalPages} • Mostrando {pageData.length} de {filtered.length}\r\n                </span>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={goPrev} disabled={!canPrev}>\r\n                    <ChevronLeft className=\"h-4 w-4\" />\r\n                  </Button>\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={goNext} disabled={!canNext}>\r\n                    <ChevronRight className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Dialog Create/Edit */}\r\n      <Dialog open={open} onOpenChange={setOpen}>\r\n        <DialogContent className=\"sm:max-w-[520px]\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <User className=\"h-5 w-5 text-blue-600\" />\r\n              {editing ? \"Editar Usuario\" : \"Crear Usuario\"}\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <form onSubmit={submit} className=\"space-y-4 pt-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label>Nombre</Label>\r\n              <Input\r\n                value={form.name}\r\n                onChange={(e) => setForm((p) => ({ ...p, name: e.target.value }))}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Email</Label>\r\n              <Input\r\n                type=\"email\"\r\n                value={form.email}\r\n                onChange={(e) => setForm((p) => ({ ...p, email: e.target.value }))}\r\n                placeholder=\"usuario@dominio.com\"\r\n                required\r\n              />\r\n            </div>\r\n\r\n            {!editing && (\r\n              <div className=\"space-y-2\">\r\n                <Label>Contraseña</Label>\r\n                <Input\r\n                  type=\"password\"\r\n                  value={form.password}\r\n                  onChange={(e) => setForm((p) => ({ ...p, password: e.target.value }))}\r\n                  placeholder=\"mínimo 6 caracteres\"\r\n                  required\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Rol</Label>\r\n              <select\r\n                className=\"w-full border rounded-md px-3 py-2 bg-white text-sm\"\r\n                value={form.role}\r\n                onChange={(e) => setForm((p) => ({ ...p, role: e.target.value as Role }))}\r\n              >\r\n                <option value=\"operator\">operator</option>\r\n                <option value=\"admin\">admin</option>\r\n              </select>\r\n            </div>\r\n\r\n            <DialogFooter className=\"pt-2\">\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setOpen(false);\r\n                  resetForm();\r\n                }}\r\n              >\r\n                Cancelar\r\n              </Button>\r\n              <Button type=\"submit\">{editing ? \"Guardar cambios\" : \"Crear\"}</Button>\r\n            </DialogFooter>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}