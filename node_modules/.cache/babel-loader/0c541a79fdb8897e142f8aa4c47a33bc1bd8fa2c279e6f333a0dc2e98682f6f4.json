{"ast":null,"code":"var _env,_env2;import React,{useEffect,useMemo,useState,useCallback}from\"react\";import{Card,CardContent}from\"../../../shared/ui/card\";import{Button}from\"../../../shared/ui/button\";import{Badge}from\"../../../shared/ui/badge\";import{Download,Eye,Camera,Calendar,Image as ImageIcon,X}from\"lucide-react\";import{http}from\"../../../api/http\";// ✅ axios con interceptor Bearer\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";/**\r\n * API_BASE: se usa para las peticiones (http ya tiene baseURL internamente)\r\n * PUBLIC_BASE: se usa para convertir \"/static/...\" a URL absoluta.\r\n *\r\n * Si REACT_APP_API_BASE = \"https://tuservicio.onrender.com/api/v1\"\r\n * entonces PUBLIC_BASE = \"https://tuservicio.onrender.com\"\r\n */const API_BASE=((_env=process.env)===null||_env===void 0?void 0:_env.REACT_APP_API_BASE)||((_env2=import.meta.env)===null||_env2===void 0?void 0:_env2.VITE_API_URL)||\"http://localhost:8000/api/v1\";const PUBLIC_BASE=String(API_BASE).replace(/\\/api\\/v1\\/?$/,\"\");function toAbsoluteEvidenceUrl(url){if(!url)return\"\";if(url.startsWith(\"http://\")||url.startsWith(\"https://\"))return url;if(url.startsWith(\"/\"))return\"\".concat(PUBLIC_BASE).concat(url);return\"\".concat(PUBLIC_BASE,\"/\").concat(url);}function normalizeConfidence(c){const n=Number(c);if(!Number.isFinite(n))return 0;const v=n>1?n/100:n;// soporta 0..100\nreturn Math.max(0,Math.min(1,v));}function severityFromConfidence(conf){if(conf>=0.95)return\"critical\";if(conf>=0.85)return\"high\";if(conf>=0.70)return\"medium\";return\"low\";}function formatDateTime(iso){const d=new Date(iso);if(!Number.isFinite(d.getTime()))return{date:\"-\",time:\"-\"};const date=d.toLocaleDateString(\"es-PE\");const time=d.toLocaleTimeString(\"es-PE\",{hour:\"2-digit\",minute:\"2-digit\",second:\"2-digit\"});return{date,time};}function ymd(iso){const d=new Date(iso);if(!Number.isFinite(d.getTime()))return\"\";const yyyy=String(d.getFullYear());const mm=String(d.getMonth()+1).padStart(2,\"0\");const dd=String(d.getDate()).padStart(2,\"0\");return\"\".concat(yyyy,\"-\").concat(mm,\"-\").concat(dd);}export function Evidence(){const[loading,setLoading]=useState(false);const[items,setItems]=useState([]);const[error,setError]=useState(null);// paginación\nconst pageSize=9;const[page,setPage]=useState(1);// modal\nconst[selected,setSelected]=useState(null);const fetchEvidence=useCallback(async()=>{setLoading(true);setError(null);try{// ✅ axios manda Authorization automáticamente\nconst{data}=await http.get(\"/incidents?limit=500\");const mapped=(Array.isArray(data)?data:[]).filter(i=>!!i.evidence_url).map(i=>{var _ref,_i$timestamp,_i$weapon_type,_i$evidence_url;const conf=normalizeConfidence(i.confidence);const ts=String((_ref=(_i$timestamp=i.timestamp)!==null&&_i$timestamp!==void 0?_i$timestamp:i.created_at)!==null&&_ref!==void 0?_ref:new Date().toISOString());return{id:String(i._id),weaponType:String((_i$weapon_type=i.weapon_type)!==null&&_i$weapon_type!==void 0?_i$weapon_type:\"desconocido\"),confidence:conf,evidenceUrl:toAbsoluteEvidenceUrl(String((_i$evidence_url=i.evidence_url)!==null&&_i$evidence_url!==void 0?_i$evidence_url:\"\")),cameraId:i.camera_id?String(i.camera_id):\"—\",timestampISO:ts,severity:severityFromConfidence(conf)};})// ✅ más reciente primero\n.sort((a,b)=>String(b.timestampISO).localeCompare(String(a.timestampISO)));setItems(mapped);setPage(1);}catch(e){var _e$response;const status=e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:_e$response.status;if(status===401)setError(\"HTTP 401: sesión expirada o token no enviado. Vuelve a iniciar sesión.\");else setError((e===null||e===void 0?void 0:e.message)||\"Error cargando evidencias\");}finally{setLoading(false);}},[]);useEffect(()=>{fetchEvidence().catch(console.error);},[fetchEvidence]);const totalPages=useMemo(()=>Math.max(1,Math.ceil(items.length/pageSize)),[items.length]);const canPrev=page>1;const canNext=page<totalPages;useEffect(()=>{setPage(p=>Math.min(p,totalPages));},[totalPages]);const pageData=useMemo(()=>{const start=(page-1)*pageSize;return items.slice(start,start+pageSize);},[items,page]);const stats=useMemo(()=>{const total=items.length;const todayYMD=(()=>{const d=new Date();const yyyy=String(d.getFullYear());const mm=String(d.getMonth()+1).padStart(2,\"0\");const dd=String(d.getDate()).padStart(2,\"0\");return\"\".concat(yyyy,\"-\").concat(mm,\"-\").concat(dd);})();const todayCount=items.filter(i=>ymd(i.timestampISO)===todayYMD).length;const avg=total>0?Math.round(items.reduce((acc,it)=>acc+it.confidence,0)/total*100):0;return{total,todayCount,avg};},[items]);const downloadFile=(url,filename)=>{if(!url)return;const a=document.createElement(\"a\");a.href=url;a.download=filename;document.body.appendChild(a);a.click();a.remove();};const severityBadge=s=>{switch(s){case\"critical\":return\"bg-rose-600 text-white\";case\"high\":return\"bg-orange-600 text-white\";case\"medium\":return\"bg-amber-600 text-white\";default:return\"bg-slate-600 text-white\";}};const startLabel=items.length===0?0:(page-1)*pageSize+1;const endLabel=Math.min(page*pageSize,items.length);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full space-y-6 pb-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row lg:items-center justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl md:text-3xl font-bold tracking-tight text-slate-900\",children:\"Galer\\xEDa de Evidencias\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-600 text-sm mt-1\",children:\"Capturas visuales de todas las detecciones registradas\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",className:\"h-10\",onClick:fetchEvidence,disabled:loading,children:loading?\"Cargando...\":\"Refrescar\"}),/*#__PURE__*/_jsxs(Button,{className:\"h-10\",onClick:()=>pageData.forEach(it=>downloadFile(it.evidenceUrl,\"evidence-\".concat(it.id,\".jpg\"))),disabled:pageData.length===0,children:[/*#__PURE__*/_jsx(Download,{className:\"h-4 w-4 mr-2\"}),\"Descargar P\\xE1gina\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"py-5 px-5 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-slate-600\",children:\"Total de Evidencias\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-slate-900 mt-1\",children:stats.total})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-100 p-3 rounded-2xl\",children:/*#__PURE__*/_jsx(ImageIcon,{className:\"h-6 w-6 text-blue-600\"})})]})}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"py-5 px-5 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-slate-600\",children:\"Hoy\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-slate-900 mt-1\",children:stats.todayCount})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-emerald-100 p-3 rounded-2xl\",children:/*#__PURE__*/_jsx(Calendar,{className:\"h-6 w-6 text-emerald-600\"})})]})}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"py-5 px-5 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-slate-600\",children:\"Confianza Promedio\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-slate-900 mt-1\",children:[stats.avg,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-amber-100 p-3 rounded-2xl\",children:/*#__PURE__*/_jsx(\"span\",{className:\"font-extrabold text-amber-700\",children:\"AI\"})})]})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4 rounded-lg border border-rose-200 bg-rose-50 text-rose-700 text-sm\",children:error}),!loading&&items.length===0&&!error&&/*#__PURE__*/_jsx(\"div\",{className:\"py-16 text-center text-slate-600\",children:\"No hay evidencias todav\\xEDa.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5\",children:pageData.map(it=>{const{date,time}=formatDateTime(it.timestampISO);const confPct=Math.round(it.confidence*100);return/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-black\",children:[/*#__PURE__*/_jsx(\"img\",{src:it.evidenceUrl,alt:\"evidence-\".concat(it.id),className:\"w-full h-44 object-cover\",loading:\"lazy\",onError:ev=>{// fallback simple si falla la imagen\nev.currentTarget.style.opacity=\"0.2\";}}),/*#__PURE__*/_jsxs(Badge,{className:\"absolute top-3 right-3 \".concat(severityBadge(it.severity),\" shadow-sm\"),children:[confPct,\"%\"]})]}),/*#__PURE__*/_jsxs(CardContent,{className:\"p-4 space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between gap-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-mono font-bold text-slate-900 truncate\",children:it.id}),/*#__PURE__*/_jsx(Badge,{variant:\"outline\",className:\"font-bold text-xs\",children:it.weaponType})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-slate-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-mono\",children:[date,\" \",time]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Camera,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-mono\",children:it.cameraId})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 pt-1\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"outline\",onClick:()=>setSelected(it),children:[/*#__PURE__*/_jsx(Eye,{className:\"h-4 w-4 mr-2\"}),\"Ver\"]}),/*#__PURE__*/_jsxs(Button,{onClick:()=>downloadFile(it.evidenceUrl,\"evidence-\".concat(it.id,\".jpg\")),children:[/*#__PURE__*/_jsx(Download,{className:\"h-4 w-4 mr-2\"}),\"Descargar\"]})]})]})]},it.id);})}),items.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center justify-between gap-3 border-t pt-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-slate-600\",children:[\"Mostrando \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-slate-900\",children:startLabel}),\" -\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-slate-900\",children:endLabel}),\" de\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-slate-900\",children:items.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>setPage(p=>Math.max(1,p-1)),disabled:!canPrev,children:\"Anterior\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs font-bold px-2\",children:[page,\" / \",totalPages]}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>setPage(p=>Math.min(totalPages,p+1)),disabled:!canNext,children:\"Siguiente\"})]})]}),selected&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-2xl w-full max-w-5xl overflow-hidden relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelected(null),className:\"absolute top-3 right-3 h-10 w-10 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center\",children:/*#__PURE__*/_jsx(X,{className:\"h-5 w-5 text-slate-700\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-5 border-b\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"min-w-0\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-bold text-slate-900 truncate\",children:[\"Evidencia \",selected.id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-slate-600\",children:[selected.weaponType,\" \\xB7 \",Math.round(selected.confidence*100),\"% \\xB7 C\\xE1mara: \",selected.cameraId]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-black rounded-xl overflow-hidden border\",children:/*#__PURE__*/_jsx(\"img\",{src:selected.evidenceUrl,alt:\"evidence-full\",className:\"w-full max-h-[70vh] object-contain bg-black\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-4\",children:[/*#__PURE__*/_jsxs(Button,{className:\"flex-1\",onClick:()=>downloadFile(selected.evidenceUrl,\"evidence-\".concat(selected.id,\".jpg\")),children:[/*#__PURE__*/_jsx(Download,{className:\"h-4 w-4 mr-2\"}),\"Descargar\"]}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",className:\"flex-1\",onClick:()=>setSelected(null),children:\"Cerrar\"})]})]})]})})]});}export default Evidence;","map":{"version":3,"names":["React","useEffect","useMemo","useState","useCallback","Card","CardContent","Button","Badge","Download","Eye","Camera","Calendar","Image","ImageIcon","X","http","jsx","_jsx","jsxs","_jsxs","API_BASE","_env","process","env","REACT_APP_API_BASE","_env2","import","meta","VITE_API_URL","PUBLIC_BASE","String","replace","toAbsoluteEvidenceUrl","url","startsWith","concat","normalizeConfidence","c","n","Number","isFinite","v","Math","max","min","severityFromConfidence","conf","formatDateTime","iso","d","Date","getTime","date","time","toLocaleDateString","toLocaleTimeString","hour","minute","second","ymd","yyyy","getFullYear","mm","getMonth","padStart","dd","getDate","Evidence","loading","setLoading","items","setItems","error","setError","pageSize","page","setPage","selected","setSelected","fetchEvidence","data","get","mapped","Array","isArray","filter","i","evidence_url","map","_ref","_i$timestamp","_i$weapon_type","_i$evidence_url","confidence","ts","timestamp","created_at","toISOString","id","_id","weaponType","weapon_type","evidenceUrl","cameraId","camera_id","timestampISO","severity","sort","a","b","localeCompare","e","_e$response","status","response","message","catch","console","totalPages","ceil","length","canPrev","canNext","p","pageData","start","slice","stats","total","todayYMD","todayCount","avg","round","reduce","acc","it","downloadFile","filename","document","createElement","href","download","body","appendChild","click","remove","severityBadge","s","startLabel","endLabel","className","children","variant","onClick","disabled","forEach","confPct","src","alt","onError","ev","currentTarget","style","opacity","size"],"sources":["D:/PROYECTO DE TESIS AÑO 2026/sistema-armas/frontend/src/modules/evidence/ui/Evidence.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState, useCallback } from \"react\";\r\nimport { Card, CardContent } from \"../../../shared/ui/card\";\r\nimport { Button } from \"../../../shared/ui/button\";\r\nimport { Badge } from \"../../../shared/ui/badge\";\r\nimport { Download, Eye, Camera, Calendar, Image as ImageIcon, X } from \"lucide-react\";\r\nimport { http } from \"../../../api/http\"; // ✅ axios con interceptor Bearer\r\n\r\ntype Severity = \"critical\" | \"high\" | \"medium\" | \"low\";\r\n\r\ninterface IncidentApi {\r\n  _id: string;\r\n  weapon_type?: string;\r\n  confidence?: number; // puede ser 0..1 o 0..100\r\n  evidence_url?: string | null;\r\n  camera_id?: string | null;\r\n  timestamp?: string | null; // ISO\r\n  created_at?: string | null; // por si acaso\r\n}\r\n\r\ninterface EvidenceItem {\r\n  id: string;\r\n  weaponType: string;\r\n  confidence: number; // 0..1\r\n  evidenceUrl: string;\r\n  cameraId: string;\r\n  timestampISO: string;\r\n  severity: Severity;\r\n}\r\n\r\n/**\r\n * API_BASE: se usa para las peticiones (http ya tiene baseURL internamente)\r\n * PUBLIC_BASE: se usa para convertir \"/static/...\" a URL absoluta.\r\n *\r\n * Si REACT_APP_API_BASE = \"https://tuservicio.onrender.com/api/v1\"\r\n * entonces PUBLIC_BASE = \"https://tuservicio.onrender.com\"\r\n */\r\nconst API_BASE =\r\n  (process as any).env?.REACT_APP_API_BASE ||\r\n  (import.meta as any).env?.VITE_API_URL ||\r\n  \"http://localhost:8000/api/v1\";\r\n\r\nconst PUBLIC_BASE = String(API_BASE).replace(/\\/api\\/v1\\/?$/, \"\");\r\n\r\nfunction toAbsoluteEvidenceUrl(url: string): string {\r\n  if (!url) return \"\";\r\n  if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) return url;\r\n  if (url.startsWith(\"/\")) return `${PUBLIC_BASE}${url}`;\r\n  return `${PUBLIC_BASE}/${url}`;\r\n}\r\n\r\nfunction normalizeConfidence(c: any): number {\r\n  const n = Number(c);\r\n  if (!Number.isFinite(n)) return 0;\r\n  const v = n > 1 ? n / 100 : n; // soporta 0..100\r\n  return Math.max(0, Math.min(1, v));\r\n}\r\n\r\nfunction severityFromConfidence(conf: number): Severity {\r\n  if (conf >= 0.95) return \"critical\";\r\n  if (conf >= 0.85) return \"high\";\r\n  if (conf >= 0.70) return \"medium\";\r\n  return \"low\";\r\n}\r\n\r\nfunction formatDateTime(iso: string) {\r\n  const d = new Date(iso);\r\n  if (!Number.isFinite(d.getTime())) return { date: \"-\", time: \"-\" };\r\n\r\n  const date = d.toLocaleDateString(\"es-PE\");\r\n  const time = d.toLocaleTimeString(\"es-PE\", { hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" });\r\n  return { date, time };\r\n}\r\n\r\nfunction ymd(iso: string): string {\r\n  const d = new Date(iso);\r\n  if (!Number.isFinite(d.getTime())) return \"\";\r\n  const yyyy = String(d.getFullYear());\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  return `${yyyy}-${mm}-${dd}`;\r\n}\r\n\r\nexport function Evidence() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [items, setItems] = useState<EvidenceItem[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // paginación\r\n  const pageSize = 9;\r\n  const [page, setPage] = useState(1);\r\n\r\n  // modal\r\n  const [selected, setSelected] = useState<EvidenceItem | null>(null);\r\n\r\n  const fetchEvidence = useCallback(async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // ✅ axios manda Authorization automáticamente\r\n      const { data } = await http.get<IncidentApi[]>(`/incidents?limit=500`);\r\n\r\n      const mapped: EvidenceItem[] = (Array.isArray(data) ? data : [])\r\n        .filter((i) => !!i.evidence_url)\r\n        .map((i) => {\r\n          const conf = normalizeConfidence(i.confidence);\r\n          const ts = String(i.timestamp ?? i.created_at ?? new Date().toISOString());\r\n          return {\r\n            id: String(i._id),\r\n            weaponType: String(i.weapon_type ?? \"desconocido\"),\r\n            confidence: conf,\r\n            evidenceUrl: toAbsoluteEvidenceUrl(String(i.evidence_url ?? \"\")),\r\n            cameraId: i.camera_id ? String(i.camera_id) : \"—\",\r\n            timestampISO: ts,\r\n            severity: severityFromConfidence(conf),\r\n          };\r\n        })\r\n        // ✅ más reciente primero\r\n        .sort((a, b) => String(b.timestampISO).localeCompare(String(a.timestampISO)));\r\n\r\n      setItems(mapped);\r\n      setPage(1);\r\n    } catch (e: any) {\r\n      const status = e?.response?.status;\r\n      if (status === 401) setError(\"HTTP 401: sesión expirada o token no enviado. Vuelve a iniciar sesión.\");\r\n      else setError(e?.message || \"Error cargando evidencias\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchEvidence().catch(console.error);\r\n  }, [fetchEvidence]);\r\n\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(items.length / pageSize)), [items.length]);\r\n  const canPrev = page > 1;\r\n  const canNext = page < totalPages;\r\n\r\n  useEffect(() => {\r\n    setPage((p) => Math.min(p, totalPages));\r\n  }, [totalPages]);\r\n\r\n  const pageData = useMemo(() => {\r\n    const start = (page - 1) * pageSize;\r\n    return items.slice(start, start + pageSize);\r\n  }, [items, page]);\r\n\r\n  const stats = useMemo(() => {\r\n    const total = items.length;\r\n\r\n    const todayYMD = (() => {\r\n      const d = new Date();\r\n      const yyyy = String(d.getFullYear());\r\n      const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n      const dd = String(d.getDate()).padStart(2, \"0\");\r\n      return `${yyyy}-${mm}-${dd}`;\r\n    })();\r\n\r\n    const todayCount = items.filter((i) => ymd(i.timestampISO) === todayYMD).length;\r\n\r\n    const avg = total > 0 ? Math.round((items.reduce((acc, it) => acc + it.confidence, 0) / total) * 100) : 0;\r\n\r\n    return { total, todayCount, avg };\r\n  }, [items]);\r\n\r\n  const downloadFile = (url: string, filename: string) => {\r\n    if (!url) return;\r\n    const a = document.createElement(\"a\");\r\n    a.href = url;\r\n    a.download = filename;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    a.remove();\r\n  };\r\n\r\n  const severityBadge = (s: Severity) => {\r\n    switch (s) {\r\n      case \"critical\":\r\n        return \"bg-rose-600 text-white\";\r\n      case \"high\":\r\n        return \"bg-orange-600 text-white\";\r\n      case \"medium\":\r\n        return \"bg-amber-600 text-white\";\r\n      default:\r\n        return \"bg-slate-600 text-white\";\r\n    }\r\n  };\r\n\r\n  const startLabel = items.length === 0 ? 0 : (page - 1) * pageSize + 1;\r\n  const endLabel = Math.min(page * pageSize, items.length);\r\n\r\n  return (\r\n    <div className=\"w-full space-y-6 pb-10\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl md:text-3xl font-bold tracking-tight text-slate-900\">Galería de Evidencias</h1>\r\n          <p className=\"text-slate-600 text-sm mt-1\">Capturas visuales de todas las detecciones registradas</p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button variant=\"outline\" className=\"h-10\" onClick={fetchEvidence} disabled={loading}>\r\n            {loading ? \"Cargando...\" : \"Refrescar\"}\r\n          </Button>\r\n\r\n          <Button\r\n            className=\"h-10\"\r\n            onClick={() => pageData.forEach((it) => downloadFile(it.evidenceUrl, `evidence-${it.id}.jpg`))}\r\n            disabled={pageData.length === 0}\r\n          >\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            Descargar Página\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"py-5 px-5 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-xs font-semibold text-slate-600\">Total de Evidencias</p>\r\n              <p className=\"text-3xl font-bold text-slate-900 mt-1\">{stats.total}</p>\r\n            </div>\r\n            <div className=\"bg-blue-100 p-3 rounded-2xl\">\r\n              <ImageIcon className=\"h-6 w-6 text-blue-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"py-5 px-5 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-xs font-semibold text-slate-600\">Hoy</p>\r\n              <p className=\"text-3xl font-bold text-slate-900 mt-1\">{stats.todayCount}</p>\r\n            </div>\r\n            <div className=\"bg-emerald-100 p-3 rounded-2xl\">\r\n              <Calendar className=\"h-6 w-6 text-emerald-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm\">\r\n          <CardContent className=\"py-5 px-5 flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-xs font-semibold text-slate-600\">Confianza Promedio</p>\r\n              <p className=\"text-3xl font-bold text-slate-900 mt-1\">{stats.avg}%</p>\r\n            </div>\r\n            <div className=\"bg-amber-100 p-3 rounded-2xl\">\r\n              <span className=\"font-extrabold text-amber-700\">AI</span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Error */}\r\n      {error && <div className=\"p-4 rounded-lg border border-rose-200 bg-rose-50 text-rose-700 text-sm\">{error}</div>}\r\n\r\n      {/* Empty */}\r\n      {!loading && items.length === 0 && !error && <div className=\"py-16 text-center text-slate-600\">No hay evidencias todavía.</div>}\r\n\r\n      {/* GRID */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5\">\r\n        {pageData.map((it) => {\r\n          const { date, time } = formatDateTime(it.timestampISO);\r\n          const confPct = Math.round(it.confidence * 100);\r\n\r\n          return (\r\n            <Card key={it.id} className=\"border-0 shadow-sm overflow-hidden\">\r\n              <div className=\"relative bg-black\">\r\n                <img\r\n                  src={it.evidenceUrl}\r\n                  alt={`evidence-${it.id}`}\r\n                  className=\"w-full h-44 object-cover\"\r\n                  loading=\"lazy\"\r\n                  onError={(ev) => {\r\n                    // fallback simple si falla la imagen\r\n                    (ev.currentTarget as HTMLImageElement).style.opacity = \"0.2\";\r\n                  }}\r\n                />\r\n\r\n                <Badge className={`absolute top-3 right-3 ${severityBadge(it.severity)} shadow-sm`}>{confPct}%</Badge>\r\n              </div>\r\n\r\n              <CardContent className=\"p-4 space-y-3\">\r\n                <div className=\"flex items-center justify-between gap-2\">\r\n                  <p className=\"font-mono font-bold text-slate-900 truncate\">{it.id}</p>\r\n                  <Badge variant=\"outline\" className=\"font-bold text-xs\">\r\n                    {it.weaponType}\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"text-xs text-slate-600 space-y-1\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Calendar className=\"h-4 w-4\" />\r\n                    <span className=\"font-mono\">\r\n                      {date} {time}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Camera className=\"h-4 w-4\" />\r\n                    <span className=\"font-mono\">{it.cameraId}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-2 pt-1\">\r\n                  <Button variant=\"outline\" onClick={() => setSelected(it)}>\r\n                    <Eye className=\"h-4 w-4 mr-2\" />\r\n                    Ver\r\n                  </Button>\r\n                  <Button onClick={() => downloadFile(it.evidenceUrl, `evidence-${it.id}.jpg`)}>\r\n                    <Download className=\"h-4 w-4 mr-2\" />\r\n                    Descargar\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Footer paginación */}\r\n      {items.length > 0 && (\r\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-3 border-t pt-4\">\r\n          <p className=\"text-xs text-slate-600\">\r\n            Mostrando <span className=\"font-bold text-slate-900\">{startLabel}</span> -{\" \"}\r\n            <span className=\"font-bold text-slate-900\">{endLabel}</span> de{\" \"}\r\n            <span className=\"font-bold text-slate-900\">{items.length}</span>\r\n          </p>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button variant=\"outline\" size=\"sm\" onClick={() => setPage((p) => Math.max(1, p - 1))} disabled={!canPrev}>\r\n              Anterior\r\n            </Button>\r\n\r\n            <div className=\"text-xs font-bold px-2\">\r\n              {page} / {totalPages}\r\n            </div>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setPage((p) => Math.min(totalPages, p + 1))}\r\n              disabled={!canNext}\r\n            >\r\n              Siguiente\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Ver */}\r\n      {selected && (\r\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm\">\r\n          <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-5xl overflow-hidden relative\">\r\n            <button\r\n              onClick={() => setSelected(null)}\r\n              className=\"absolute top-3 right-3 h-10 w-10 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center\"\r\n            >\r\n              <X className=\"h-5 w-5 text-slate-700\" />\r\n            </button>\r\n\r\n            <div className=\"p-5 border-b\">\r\n              <div className=\"min-w-0\">\r\n                <h2 className=\"text-lg font-bold text-slate-900 truncate\">Evidencia {selected.id}</h2>\r\n                <p className=\"text-sm text-slate-600\">\r\n                  {selected.weaponType} · {Math.round(selected.confidence * 100)}% · Cámara: {selected.cameraId}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-5\">\r\n              <div className=\"bg-black rounded-xl overflow-hidden border\">\r\n                <img src={selected.evidenceUrl} alt=\"evidence-full\" className=\"w-full max-h-[70vh] object-contain bg-black\" />\r\n              </div>\r\n\r\n              <div className=\"flex gap-3 pt-4\">\r\n                <Button className=\"flex-1\" onClick={() => downloadFile(selected.evidenceUrl, `evidence-${selected.id}.jpg`)}>\r\n                  <Download className=\"h-4 w-4 mr-2\" />\r\n                  Descargar\r\n                </Button>\r\n                <Button variant=\"outline\" className=\"flex-1\" onClick={() => setSelected(null)}>\r\n                  Cerrar\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Evidence;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}