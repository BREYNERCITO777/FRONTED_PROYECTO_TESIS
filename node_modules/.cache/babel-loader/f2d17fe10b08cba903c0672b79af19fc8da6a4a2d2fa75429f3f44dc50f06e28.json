{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROYECTO DE TESIS A\\xD1O 2026\\\\sistema-armas\\\\frontend\\\\src\\\\modules\\\\cameras\\\\ui\\\\Cameras.tsx\",\n  _s = $RefreshSig$();\nimport React, { useMemo, useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../../shared/ui/card\";\nimport { Button } from \"../../../shared/ui/button\";\nimport { Badge } from \"../../../shared/ui/badge\";\nimport { Input } from \"../../../shared/ui/input\";\nimport { Label } from \"../../../shared/ui/label\";\nimport { Switch } from \"../../../shared/ui/switch\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"../../../shared/ui/dialog\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../../shared/ui/table\";\nimport { Play, Square, Pencil, Trash2, Plus, Video, Activity, Server, ChevronLeft, ChevronRight, Eye } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { listCameras, createCamera, updateCamera, deleteCamera, startCamera, stopCamera } from \"../../../api/cameras\";\n\n// ‚úÖ IMPORTA TU AUTH HOOK (ajusta la ruta si es distinta)\nimport { useAuth } from \"../../../context/auth-context\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n// Base para stream (tu env tiene /api/v1 incluido)\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\n\n// Mapper tolerante a campos del backend\nfunction normalizeCamera(raw) {\n  var _ref, _raw$_id, _raw$name, _raw$rtsp_url, _raw$fps_target, _raw$infer_every_n_fr, _raw$status;\n  const id = String((_ref = (_raw$_id = raw._id) !== null && _raw$_id !== void 0 ? _raw$_id : raw.id) !== null && _ref !== void 0 ? _ref : \"\");\n  const name = String((_raw$name = raw.name) !== null && _raw$name !== void 0 ? _raw$name : \"C√°mara\");\n  const rtsp_url = String((_raw$rtsp_url = raw.rtsp_url) !== null && _raw$rtsp_url !== void 0 ? _raw$rtsp_url : \"0\");\n  const enabled = raw.enabled === undefined ? true : Boolean(raw.enabled);\n  const fps_target = Number((_raw$fps_target = raw.fps_target) !== null && _raw$fps_target !== void 0 ? _raw$fps_target : 30) || 30;\n  const infer_every_n_frames = Number((_raw$infer_every_n_fr = raw.infer_every_n_frames) !== null && _raw$infer_every_n_fr !== void 0 ? _raw$infer_every_n_fr : 5) || 5;\n\n  // ‚úÖ Si backend ya manda status, √∫salo. Si no, infiere por enabled.\n  const rawStatus = String((_raw$status = raw.status) !== null && _raw$status !== void 0 ? _raw$status : \"\").toUpperCase();\n  const status = rawStatus === \"RUNNING\" || rawStatus === \"STOPPED\" ? rawStatus : enabled ? \"RUNNING\" : \"STOPPED\";\n  return {\n    id,\n    name,\n    rtsp_url,\n    enabled,\n    fps_target,\n    infer_every_n_frames,\n    status\n  };\n}\nexport function Cameras() {\n  _s();\n  var _user$role;\n  const {\n    user,\n    token\n  } = useAuth();\n  const isAdmin = (user === null || user === void 0 ? void 0 : user.role) === \"admin\";\n  const [loading, setLoading] = useState(true);\n  const [cameras, setCameras] = useState([]);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isVideoModalOpen, setIsVideoModalOpen] = useState(false);\n  const [activeVideoCamera, setActiveVideoCamera] = useState(null);\n  const [editingCamera, setEditingCamera] = useState(null);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    rtsp_url: \"\",\n    enabled: true,\n    fps_target: 30,\n    infer_every_n_frames: 5\n  });\n\n  // ‚úÖ Stream URL: usa token por query para que funcione en <img>\n  // IMPORTANTE: esto requiere que tu backend acepte ?token=...\n  const getStreamUrl = cameraId => {\n    const base = `${API_BASE}/inference/stream/${cameraId}`;\n    if (!token) return base;\n    const sep = base.includes(\"?\") ? \"&\" : \"?\";\n    return `${base}${sep}token=${encodeURIComponent(token)}`;\n  };\n\n  // Cargar c√°maras del backend\n  async function refresh() {\n    try {\n      const data = await listCameras();\n      const normalized = Array.isArray(data) ? data.map(normalizeCamera) : [];\n      setCameras(normalized);\n    } catch (e) {\n      var _e$response;\n      console.error(\"listCameras error:\", e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudieron cargar las c√°maras\");\n    }\n  }\n  useEffect(() => {\n    (async () => {\n      setLoading(true);\n      await refresh();\n      setLoading(false);\n    })();\n  }, []);\n\n  // PAGINACI√ìN\n  const pageSize = 5;\n  const [page, setPage] = useState(1);\n  const totalPages = Math.max(1, Math.ceil(cameras.length / pageSize));\n  useEffect(() => {\n    setPage(p => Math.min(p, totalPages));\n  }, [totalPages]);\n  const pageData = useMemo(() => {\n    const start = (page - 1) * pageSize;\n    return cameras.slice(start, start + pageSize);\n  }, [cameras, page]);\n  const canPrev = page > 1;\n  const canNext = page < totalPages;\n  const goPrev = () => setPage(p => Math.max(1, p - 1));\n  const goNext = () => setPage(p => Math.min(totalPages, p + 1));\n  const handleStartStop = async (id, currentStatus) => {\n    // ‚úÖ operador no puede\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para iniciar/detener c√°maras\");\n      return;\n    }\n    const nextStatus = currentStatus === \"RUNNING\" ? \"STOPPED\" : \"RUNNING\";\n\n    // Optimistic UI\n    setCameras(prev => prev.map(cam => cam.id === id ? {\n      ...cam,\n      status: nextStatus\n    } : cam));\n    try {\n      if (currentStatus === \"RUNNING\") {\n        await stopCamera(id);\n        toast.success(\"üî¥ Detenida\");\n      } else {\n        await startCamera(id);\n        toast.success(\"üü¢ Iniciada\");\n      }\n    } catch (e) {\n      var _e$response2;\n      console.error(\"start/stop error:\", e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : _e$response2.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudo cambiar el estado\");\n      // rollback\n      setCameras(prev => prev.map(cam => cam.id === id ? {\n        ...cam,\n        status: currentStatus\n      } : cam));\n    }\n  };\n  const handleDelete = async (id, name) => {\n    // ‚úÖ operador no puede\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para eliminar c√°maras\");\n      return;\n    }\n    const prev = cameras;\n    setCameras(p => p.filter(c => c.id !== id));\n    try {\n      await deleteCamera(id);\n      toast.success(`C√°mara \"${name}\" eliminada`);\n    } catch (e) {\n      var _e$response3;\n      console.error(\"delete error:\", e === null || e === void 0 ? void 0 : (_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : _e$response3.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudo eliminar la c√°mara\");\n      setCameras(prev); // rollback\n    }\n  };\n  const handleEdit = camera => {\n    // ‚úÖ operador no puede\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para editar c√°maras\");\n      return;\n    }\n    setEditingCamera(camera);\n    setFormData({\n      name: camera.name,\n      rtsp_url: camera.rtsp_url,\n      enabled: camera.enabled,\n      fps_target: camera.fps_target,\n      infer_every_n_frames: camera.infer_every_n_frames\n    });\n    setIsDialogOpen(true);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    // ‚úÖ operador no puede\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para guardar c√°maras\");\n      return;\n    }\n    try {\n      if (editingCamera) {\n        await updateCamera(editingCamera.id, formData);\n        toast.success(\"C√°mara actualizada\");\n      } else {\n        await createCamera(formData);\n        toast.success(\"C√°mara creada\");\n      }\n      setIsDialogOpen(false);\n      setEditingCamera(null);\n      await refresh();\n    } catch (e) {\n      var _e$response4;\n      console.error(\"save camera error:\", e === null || e === void 0 ? void 0 : (_e$response4 = e.response) === null || _e$response4 === void 0 ? void 0 : _e$response4.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudo guardar la c√°mara\");\n    }\n  };\n  const runningCameras = cameras.filter(c => c.status === \"RUNNING\").length;\n  const stoppedCameras = cameras.filter(c => c.status === \"STOPPED\").length;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-slate-900\",\n          children: \"Gesti\\xF3n de C\\xE1maras\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-slate-600\",\n          children: \"Monitoreo y administraci\\xF3n de dispositivos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-slate-500 mt-1\",\n          children: [\"Rol actual: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-semibold\",\n            children: (_user$role = user === null || user === void 0 ? void 0 : user.role) !== null && _user$role !== void 0 ? _user$role : \"‚Äî\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => refresh(),\n          children: \"Refrescar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n          open: isDialogOpen,\n          onOpenChange: setIsDialogOpen,\n          children: [/*#__PURE__*/_jsxDEV(DialogTrigger, {\n            asChild: true,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              disabled: !isAdmin,\n              title: !isAdmin ? \"Solo admin puede crear c√°maras\" : undefined,\n              onClick: () => {\n                if (!isAdmin) return;\n                setEditingCamera(null);\n                setFormData({\n                  name: \"\",\n                  rtsp_url: \"\",\n                  enabled: true,\n                  fps_target: 30,\n                  infer_every_n_frames: 5\n                });\n              },\n              children: [/*#__PURE__*/_jsxDEV(Plus, {\n                className: \"h-5 w-5 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 17\n              }, this), \" Nueva C\\xE1mara\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n            className: \"sm:max-w-[500px]\",\n            children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n              children: /*#__PURE__*/_jsxDEV(DialogTitle, {\n                className: \"flex items-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(Video, {\n                  className: \"h-5 w-5 text-blue-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 19\n                }, this), editingCamera ? \"Editar C√°mara\" : \"Nueva C√°mara\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleSubmit,\n              className: \"space-y-4 pt-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Nombre\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 315,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  value: formData.name,\n                  onChange: e => setFormData({\n                    ...formData,\n                    name: e.target.value\n                  }),\n                  placeholder: \"Ej: Pasillo A\",\n                  required: true,\n                  disabled: !isAdmin\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 316,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"URL RTSP / Fuente\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 326,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  value: formData.rtsp_url,\n                  onChange: e => setFormData({\n                    ...formData,\n                    rtsp_url: e.target.value\n                  }),\n                  placeholder: \"0 o rtsp://...\",\n                  required: true,\n                  disabled: !isAdmin\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 327,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between p-3 bg-slate-50 rounded-lg border\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Habilitar detecci\\xF3n\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Switch, {\n                  checked: formData.enabled,\n                  onCheckedChange: checked => setFormData({\n                    ...formData,\n                    enabled: checked\n                  }),\n                  disabled: !isAdmin\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 336,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(DialogFooter, {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"submit\",\n                  className: \"w-full\",\n                  disabled: !isAdmin,\n                  children: editingCamera ? \"Actualizar\" : \"Crear\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 348,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-4 gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(Card, {\n        className: \"border-0 shadow-sm border-l-4 border-l-emerald-500\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-bold text-slate-500\",\n                children: \"ACTIVAS\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-2xl font-bold\",\n                children: runningCameras\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Play, {\n              className: \"h-5 w-5 text-emerald-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        className: \"border-0 shadow-sm border-l-4 border-l-slate-400\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-bold text-slate-500\",\n                children: \"DETENIDAS\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-2xl font-bold\",\n                children: stoppedCameras\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Square, {\n              className: \"h-5 w-5 text-slate-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        className: \"border-0 shadow-sm border-l-4 border-l-blue-500\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-bold text-slate-500\",\n                children: \"ACTIVIDAD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 388,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-2xl font-bold\",\n                children: [cameras.length ? Math.round(runningCameras / cameras.length * 100) : 0, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 389,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Activity, {\n              className: \"h-5 w-5 text-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 393,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      className: \"border-0 shadow-sm\",\n      children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n        className: \"bg-slate-50/50 border-b\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(Server, {\n            className: \"h-4 w-4 text-slate-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CardTitle, {\n            className: \"text-sm\",\n            children: \"Listado de Dispositivos\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n        className: \"p-0\",\n        children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 text-sm text-slate-500\",\n          children: \"Cargando c\\xE1maras...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Table, {\n            children: [/*#__PURE__*/_jsxDEV(TableHeader, {\n              children: /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"ID\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"C\\xE1mara\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 417,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  className: \"text-center\",\n                  children: \"Estado\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 418,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  className: \"text-right\",\n                  children: \"Acciones\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 419,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n              children: pageData.map(camera => /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"font-mono text-xs\",\n                  children: camera.id\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 426,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"font-semibold\",\n                  children: camera.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 427,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"text-center\",\n                  children: /*#__PURE__*/_jsxDEV(Badge, {\n                    className: camera.status === \"RUNNING\" ? \"bg-emerald-100 text-emerald-700\" : \"bg-slate-100 text-slate-600\",\n                    children: camera.status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 429,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 428,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"text-right flex justify-end gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    onClick: () => {\n                      setActiveVideoCamera(camera);\n                      setIsVideoModalOpen(true);\n                    },\n                    disabled: camera.status === \"STOPPED\",\n                    children: [/*#__PURE__*/_jsxDEV(Eye, {\n                      className: \"h-4 w-4 mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 449,\n                      columnNumber: 27\n                    }, this), \" Ver\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 441,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    variant: \"outline\",\n                    onClick: () => handleStartStop(camera.id, camera.status),\n                    disabled: !isAdmin,\n                    title: !isAdmin ? \"Solo admin puede iniciar/detener\" : undefined,\n                    children: camera.status === \"RUNNING\" ? /*#__PURE__*/_jsxDEV(Square, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 461,\n                      columnNumber: 29\n                    }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 463,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 453,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    variant: \"outline\",\n                    onClick: () => handleEdit(camera),\n                    disabled: !isAdmin,\n                    title: !isAdmin ? \"Solo admin puede editar\" : undefined,\n                    children: /*#__PURE__*/_jsxDEV(Pencil, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 475,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 468,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    variant: \"outline\",\n                    className: \"text-rose-600\",\n                    onClick: () => handleDelete(camera.id, camera.name),\n                    disabled: !isAdmin,\n                    title: !isAdmin ? \"Solo admin puede eliminar\" : undefined,\n                    children: /*#__PURE__*/_jsxDEV(Trash2, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 487,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 479,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 440,\n                  columnNumber: 23\n                }, this)]\n              }, camera.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 border-t flex items-center justify-between bg-slate-50/30\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-slate-500\",\n              children: [\"P\\xE1gina \", page, \" de \", totalPages]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline\",\n                size: \"sm\",\n                onClick: goPrev,\n                disabled: !canPrev,\n                children: /*#__PURE__*/_jsxDEV(ChevronLeft, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 502,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline\",\n                size: \"sm\",\n                onClick: goNext,\n                disabled: !canNext,\n                children: /*#__PURE__*/_jsxDEV(ChevronRight, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 505,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 504,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: isVideoModalOpen,\n      onOpenChange: setIsVideoModalOpen,\n      children: /*#__PURE__*/_jsxDEV(DialogContent, {\n        className: \"sm:max-w-4xl bg-slate-950 border-slate-800\",\n        children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n          children: /*#__PURE__*/_jsxDEV(DialogTitle, {\n            className: \"text-slate-100 uppercase text-xs tracking-widest\",\n            children: [\"En Vivo: \", activeVideoCamera === null || activeVideoCamera === void 0 ? void 0 : activeVideoCamera.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aspect-video bg-black rounded-lg overflow-hidden border border-slate-800\",\n          children: activeVideoCamera && /*#__PURE__*/_jsxDEV(\"img\", {\n            src: getStreamUrl(activeVideoCamera.id),\n            alt: \"Live\",\n            className: \"w-full h-full object-contain\",\n            onError: () => {\n              // Esto te ayuda a detectar r√°pido si el backend no acepta ?token=\n              toast.error(\"No se pudo cargar el stream. Revisa si el backend acepta ?token= en /inference/stream.\");\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 11\n        }, this), activeVideoCamera && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-slate-300 break-all\",\n          children: [\"Stream URL: \", getStreamUrl(activeVideoCamera.id)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 515,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 267,\n    columnNumber: 5\n  }, this);\n}\n_s(Cameras, \"hEfPykXptJfRb08JpZdZIdqbhck=\", false, function () {\n  return [useAuth];\n});\n_c = Cameras;\nvar _c;\n$RefreshReg$(_c, \"Cameras\");","map":{"version":3,"names":["React","useMemo","useState","useEffect","Card","CardContent","CardHeader","CardTitle","Button","Badge","Input","Label","Switch","Dialog","DialogContent","DialogHeader","DialogTitle","DialogTrigger","DialogFooter","Table","TableBody","TableCell","TableHead","TableHeader","TableRow","Play","Square","Pencil","Trash2","Plus","Video","Activity","Server","ChevronLeft","ChevronRight","Eye","toast","listCameras","createCamera","updateCamera","deleteCamera","startCamera","stopCamera","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","API_BASE","process","env","REACT_APP_API_BASE","normalizeCamera","raw","_ref","_raw$_id","_raw$name","_raw$rtsp_url","_raw$fps_target","_raw$infer_every_n_fr","_raw$status","id","String","_id","name","rtsp_url","enabled","undefined","Boolean","fps_target","Number","infer_every_n_frames","rawStatus","status","toUpperCase","Cameras","_s","_user$role","user","token","isAdmin","role","loading","setLoading","cameras","setCameras","isDialogOpen","setIsDialogOpen","isVideoModalOpen","setIsVideoModalOpen","activeVideoCamera","setActiveVideoCamera","editingCamera","setEditingCamera","formData","setFormData","getStreamUrl","cameraId","base","sep","includes","encodeURIComponent","refresh","data","normalized","Array","isArray","map","e","_e$response","console","error","response","message","pageSize","page","setPage","totalPages","Math","max","ceil","length","p","min","pageData","start","slice","canPrev","canNext","goPrev","goNext","handleStartStop","currentStatus","nextStatus","prev","cam","success","_e$response2","handleDelete","filter","c","_e$response3","handleEdit","camera","handleSubmit","preventDefault","_e$response4","runningCameras","stoppedCameras","className","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","open","onOpenChange","asChild","disabled","title","onSubmit","value","onChange","target","placeholder","required","checked","onCheckedChange","type","round","size","src","alt","onError","_c","$RefreshReg$"],"sources":["D:/PROYECTO DE TESIS A√ëO 2026/sistema-armas/frontend/src/modules/cameras/ui/Cameras.tsx"],"sourcesContent":["import React, { useMemo, useState, useEffect } from \"react\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../../shared/ui/card\";\r\nimport { Button } from \"../../../shared/ui/button\";\r\nimport { Badge } from \"../../../shared/ui/badge\";\r\nimport { Input } from \"../../../shared/ui/input\";\r\nimport { Label } from \"../../../shared/ui/label\";\r\nimport { Switch } from \"../../../shared/ui/switch\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n  DialogFooter,\r\n} from \"../../../shared/ui/dialog\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"../../../shared/ui/table\";\r\nimport {\r\n  Play,\r\n  Square,\r\n  Pencil,\r\n  Trash2,\r\n  Plus,\r\n  Video,\r\n  Activity,\r\n  Server,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  Eye,\r\n} from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\n\r\nimport {\r\n  listCameras,\r\n  createCamera,\r\n  updateCamera,\r\n  deleteCamera,\r\n  startCamera,\r\n  stopCamera,\r\n} from \"../../../api/cameras\";\r\n\r\n// ‚úÖ IMPORTA TU AUTH HOOK (ajusta la ruta si es distinta)\r\nimport { useAuth } from \"../../../context/auth-context\";\r\n\r\ninterface Camera {\r\n  id: string;\r\n  name: string;\r\n  rtsp_url: string;\r\n  enabled: boolean;\r\n  fps_target: number;\r\n  infer_every_n_frames: number;\r\n  status: \"RUNNING\" | \"STOPPED\";\r\n}\r\n\r\n// Base para stream (tu env tiene /api/v1 incluido)\r\nconst API_BASE =\r\n  process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\r\n\r\n// Mapper tolerante a campos del backend\r\nfunction normalizeCamera(raw: any): Camera {\r\n  const id = String(raw._id ?? raw.id ?? \"\");\r\n\r\n  const name = String(raw.name ?? \"C√°mara\");\r\n\r\n  const rtsp_url = String(raw.rtsp_url ?? \"0\");\r\n\r\n  const enabled = raw.enabled === undefined ? true : Boolean(raw.enabled);\r\n\r\n  const fps_target = Number(raw.fps_target ?? 30) || 30;\r\n\r\n  const infer_every_n_frames = Number(raw.infer_every_n_frames ?? 5) || 5;\r\n\r\n  // ‚úÖ Si backend ya manda status, √∫salo. Si no, infiere por enabled.\r\n  const rawStatus = String(raw.status ?? \"\").toUpperCase();\r\n  const status: Camera[\"status\"] =\r\n    rawStatus === \"RUNNING\" || rawStatus === \"STOPPED\"\r\n      ? (rawStatus as Camera[\"status\"])\r\n      : enabled\r\n      ? \"RUNNING\"\r\n      : \"STOPPED\";\r\n\r\n  return {\r\n    id,\r\n    name,\r\n    rtsp_url,\r\n    enabled,\r\n    fps_target,\r\n    infer_every_n_frames,\r\n    status,\r\n  };\r\n}\r\n\r\nexport function Cameras() {\r\n  const { user, token } = useAuth();\r\n  const isAdmin = user?.role === \"admin\";\r\n\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [cameras, setCameras] = useState<Camera[]>([]);\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n  const [isVideoModalOpen, setIsVideoModalOpen] = useState(false);\r\n  const [activeVideoCamera, setActiveVideoCamera] = useState<Camera | null>(null);\r\n  const [editingCamera, setEditingCamera] = useState<Camera | null>(null);\r\n\r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    rtsp_url: \"\",\r\n    enabled: true,\r\n    fps_target: 30,\r\n    infer_every_n_frames: 5,\r\n  });\r\n\r\n  // ‚úÖ Stream URL: usa token por query para que funcione en <img>\r\n  // IMPORTANTE: esto requiere que tu backend acepte ?token=...\r\n  const getStreamUrl = (cameraId: string) => {\r\n    const base = `${API_BASE}/inference/stream/${cameraId}`;\r\n    if (!token) return base;\r\n    const sep = base.includes(\"?\") ? \"&\" : \"?\";\r\n    return `${base}${sep}token=${encodeURIComponent(token)}`;\r\n  };\r\n\r\n  // Cargar c√°maras del backend\r\n  async function refresh() {\r\n    try {\r\n      const data = await listCameras();\r\n      const normalized = Array.isArray(data) ? data.map(normalizeCamera) : [];\r\n      setCameras(normalized);\r\n    } catch (e: any) {\r\n      console.error(\"listCameras error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudieron cargar las c√°maras\");\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      setLoading(true);\r\n      await refresh();\r\n      setLoading(false);\r\n    })();\r\n  }, []);\r\n\r\n  // PAGINACI√ìN\r\n  const pageSize = 5;\r\n  const [page, setPage] = useState(1);\r\n  const totalPages = Math.max(1, Math.ceil(cameras.length / pageSize));\r\n\r\n  useEffect(() => {\r\n    setPage((p) => Math.min(p, totalPages));\r\n  }, [totalPages]);\r\n\r\n  const pageData = useMemo(() => {\r\n    const start = (page - 1) * pageSize;\r\n    return cameras.slice(start, start + pageSize);\r\n  }, [cameras, page]);\r\n\r\n  const canPrev = page > 1;\r\n  const canNext = page < totalPages;\r\n  const goPrev = () => setPage((p) => Math.max(1, p - 1));\r\n  const goNext = () => setPage((p) => Math.min(totalPages, p + 1));\r\n\r\n  const handleStartStop = async (id: string, currentStatus: Camera[\"status\"]) => {\r\n    // ‚úÖ operador no puede\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para iniciar/detener c√°maras\");\r\n      return;\r\n    }\r\n\r\n    const nextStatus = currentStatus === \"RUNNING\" ? \"STOPPED\" : \"RUNNING\";\r\n\r\n    // Optimistic UI\r\n    setCameras((prev) =>\r\n      prev.map((cam) => (cam.id === id ? { ...cam, status: nextStatus } : cam))\r\n    );\r\n\r\n    try {\r\n      if (currentStatus === \"RUNNING\") {\r\n        await stopCamera(id);\r\n        toast.success(\"üî¥ Detenida\");\r\n      } else {\r\n        await startCamera(id);\r\n        toast.success(\"üü¢ Iniciada\");\r\n      }\r\n    } catch (e: any) {\r\n      console.error(\"start/stop error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudo cambiar el estado\");\r\n      // rollback\r\n      setCameras((prev) =>\r\n        prev.map((cam) => (cam.id === id ? { ...cam, status: currentStatus } : cam))\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id: string, name: string) => {\r\n    // ‚úÖ operador no puede\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para eliminar c√°maras\");\r\n      return;\r\n    }\r\n\r\n    const prev = cameras;\r\n    setCameras((p) => p.filter((c) => c.id !== id));\r\n\r\n    try {\r\n      await deleteCamera(id);\r\n      toast.success(`C√°mara \"${name}\" eliminada`);\r\n    } catch (e: any) {\r\n      console.error(\"delete error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudo eliminar la c√°mara\");\r\n      setCameras(prev); // rollback\r\n    }\r\n  };\r\n\r\n  const handleEdit = (camera: Camera) => {\r\n    // ‚úÖ operador no puede\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para editar c√°maras\");\r\n      return;\r\n    }\r\n\r\n    setEditingCamera(camera);\r\n    setFormData({\r\n      name: camera.name,\r\n      rtsp_url: camera.rtsp_url,\r\n      enabled: camera.enabled,\r\n      fps_target: camera.fps_target,\r\n      infer_every_n_frames: camera.infer_every_n_frames,\r\n    });\r\n    setIsDialogOpen(true);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    // ‚úÖ operador no puede\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para guardar c√°maras\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (editingCamera) {\r\n        await updateCamera(editingCamera.id, formData);\r\n        toast.success(\"C√°mara actualizada\");\r\n      } else {\r\n        await createCamera(formData);\r\n        toast.success(\"C√°mara creada\");\r\n      }\r\n      setIsDialogOpen(false);\r\n      setEditingCamera(null);\r\n      await refresh();\r\n    } catch (e: any) {\r\n      console.error(\"save camera error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudo guardar la c√°mara\");\r\n    }\r\n  };\r\n\r\n  const runningCameras = cameras.filter((c) => c.status === \"RUNNING\").length;\r\n  const stoppedCameras = cameras.filter((c) => c.status === \"STOPPED\").length;\r\n\r\n  return (\r\n    <div className=\"space-y-5\">\r\n      {/* HEADER Y BOT√ìN NUEVA C√ÅMARA */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-slate-900\">Gesti√≥n de C√°maras</h1>\r\n          <p className=\"text-sm text-slate-600\">Monitoreo y administraci√≥n de dispositivos</p>\r\n          <p className=\"text-xs text-slate-500 mt-1\">\r\n            Rol actual: <span className=\"font-semibold\">{user?.role ?? \"‚Äî\"}</span>\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button variant=\"outline\" onClick={() => refresh()}>\r\n            Refrescar\r\n          </Button>\r\n\r\n          {/* ‚úÖ Solo admin puede crear */}\r\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n            <DialogTrigger asChild>\r\n              <Button\r\n                disabled={!isAdmin}\r\n                title={!isAdmin ? \"Solo admin puede crear c√°maras\" : undefined}\r\n                onClick={() => {\r\n                  if (!isAdmin) return;\r\n                  setEditingCamera(null);\r\n                  setFormData({\r\n                    name: \"\",\r\n                    rtsp_url: \"\",\r\n                    enabled: true,\r\n                    fps_target: 30,\r\n                    infer_every_n_frames: 5,\r\n                  });\r\n                }}\r\n              >\r\n                <Plus className=\"h-5 w-5 mr-2\" /> Nueva C√°mara\r\n              </Button>\r\n            </DialogTrigger>\r\n\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n              <DialogHeader>\r\n                <DialogTitle className=\"flex items-center gap-2\">\r\n                  <Video className=\"h-5 w-5 text-blue-600\" />\r\n                  {editingCamera ? \"Editar C√°mara\" : \"Nueva C√°mara\"}\r\n                </DialogTitle>\r\n              </DialogHeader>\r\n\r\n              <form onSubmit={handleSubmit} className=\"space-y-4 pt-2\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Nombre</Label>\r\n                  <Input\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    placeholder=\"Ej: Pasillo A\"\r\n                    required\r\n                    disabled={!isAdmin}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>URL RTSP / Fuente</Label>\r\n                  <Input\r\n                    value={formData.rtsp_url}\r\n                    onChange={(e) => setFormData({ ...formData, rtsp_url: e.target.value })}\r\n                    placeholder=\"0 o rtsp://...\"\r\n                    required\r\n                    disabled={!isAdmin}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg border\">\r\n                  <Label>Habilitar detecci√≥n</Label>\r\n                  <Switch\r\n                    checked={formData.enabled}\r\n                    onCheckedChange={(checked) =>\r\n                      setFormData({ ...formData, enabled: checked })\r\n                    }\r\n                    disabled={!isAdmin}\r\n                  />\r\n                </div>\r\n\r\n                <DialogFooter>\r\n                  <Button type=\"submit\" className=\"w-full\" disabled={!isAdmin}>\r\n                    {editingCamera ? \"Actualizar\" : \"Crear\"}\r\n                  </Button>\r\n                </DialogFooter>\r\n              </form>\r\n            </DialogContent>\r\n          </Dialog>\r\n        </div>\r\n      </div>\r\n\r\n      {/* STATS CARDS */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card className=\"border-0 shadow-sm border-l-4 border-l-emerald-500\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-slate-500\">ACTIVAS</p>\r\n                <p className=\"text-2xl font-bold\">{runningCameras}</p>\r\n              </div>\r\n              <Play className=\"h-5 w-5 text-emerald-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm border-l-4 border-l-slate-400\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-slate-500\">DETENIDAS</p>\r\n                <p className=\"text-2xl font-bold\">{stoppedCameras}</p>\r\n              </div>\r\n              <Square className=\"h-5 w-5 text-slate-400\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm border-l-4 border-l-blue-500\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-slate-500\">ACTIVIDAD</p>\r\n                <p className=\"text-2xl font-bold\">\r\n                  {cameras.length ? Math.round((runningCameras / cameras.length) * 100) : 0}%\r\n                </p>\r\n              </div>\r\n              <Activity className=\"h-5 w-5 text-blue-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* TABLA */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <CardHeader className=\"bg-slate-50/50 border-b\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Server className=\"h-4 w-4 text-slate-500\" />\r\n            <CardTitle className=\"text-sm\">Listado de Dispositivos</CardTitle>\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-0\">\r\n          {loading ? (\r\n            <div className=\"p-6 text-sm text-slate-500\">Cargando c√°maras...</div>\r\n          ) : (\r\n            <>\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>ID</TableHead>\r\n                    <TableHead>C√°mara</TableHead>\r\n                    <TableHead className=\"text-center\">Estado</TableHead>\r\n                    <TableHead className=\"text-right\">Acciones</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n\r\n                <TableBody>\r\n                  {pageData.map((camera) => (\r\n                    <TableRow key={camera.id}>\r\n                      <TableCell className=\"font-mono text-xs\">{camera.id}</TableCell>\r\n                      <TableCell className=\"font-semibold\">{camera.name}</TableCell>\r\n                      <TableCell className=\"text-center\">\r\n                        <Badge\r\n                          className={\r\n                            camera.status === \"RUNNING\"\r\n                              ? \"bg-emerald-100 text-emerald-700\"\r\n                              : \"bg-slate-100 text-slate-600\"\r\n                          }\r\n                        >\r\n                          {camera.status}\r\n                        </Badge>\r\n                      </TableCell>\r\n\r\n                      <TableCell className=\"text-right flex justify-end gap-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          onClick={() => {\r\n                            setActiveVideoCamera(camera);\r\n                            setIsVideoModalOpen(true);\r\n                          }}\r\n                          disabled={camera.status === \"STOPPED\"}\r\n                        >\r\n                          <Eye className=\"h-4 w-4 mr-1\" /> Ver\r\n                        </Button>\r\n\r\n                        {/* ‚úÖ Solo admin puede start/stop */}\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleStartStop(camera.id, camera.status)}\r\n                          disabled={!isAdmin}\r\n                          title={!isAdmin ? \"Solo admin puede iniciar/detener\" : undefined}\r\n                        >\r\n                          {camera.status === \"RUNNING\" ? (\r\n                            <Square className=\"h-4 w-4\" />\r\n                          ) : (\r\n                            <Play className=\"h-4 w-4\" />\r\n                          )}\r\n                        </Button>\r\n\r\n                        {/* ‚úÖ Solo admin puede editar */}\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleEdit(camera)}\r\n                          disabled={!isAdmin}\r\n                          title={!isAdmin ? \"Solo admin puede editar\" : undefined}\r\n                        >\r\n                          <Pencil className=\"h-4 w-4\" />\r\n                        </Button>\r\n\r\n                        {/* ‚úÖ Solo admin puede borrar */}\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          className=\"text-rose-600\"\r\n                          onClick={() => handleDelete(camera.id, camera.name)}\r\n                          disabled={!isAdmin}\r\n                          title={!isAdmin ? \"Solo admin puede eliminar\" : undefined}\r\n                        >\r\n                          <Trash2 className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n\r\n              {/* PAGINACI√ìN */}\r\n              <div className=\"p-4 border-t flex items-center justify-between bg-slate-50/30\">\r\n                <span className=\"text-xs text-slate-500\">\r\n                  P√°gina {page} de {totalPages}\r\n                </span>\r\n                <div className=\"flex gap-2\">\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={goPrev} disabled={!canPrev}>\r\n                    <ChevronLeft className=\"h-4 w-4\" />\r\n                  </Button>\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={goNext} disabled={!canNext}>\r\n                    <ChevronRight className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* MODAL DE VIDEO */}\r\n      <Dialog open={isVideoModalOpen} onOpenChange={setIsVideoModalOpen}>\r\n        <DialogContent className=\"sm:max-w-4xl bg-slate-950 border-slate-800\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"text-slate-100 uppercase text-xs tracking-widest\">\r\n              En Vivo: {activeVideoCamera?.name}\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"aspect-video bg-black rounded-lg overflow-hidden border border-slate-800\">\r\n            {activeVideoCamera && (\r\n              <img\r\n                src={getStreamUrl(activeVideoCamera.id)}\r\n                alt=\"Live\"\r\n                className=\"w-full h-full object-contain\"\r\n                onError={() => {\r\n                  // Esto te ayuda a detectar r√°pido si el backend no acepta ?token=\r\n                  toast.error(\r\n                    \"No se pudo cargar el stream. Revisa si el backend acepta ?token= en /inference/stream.\"\r\n                  );\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n\r\n          {/* ‚úÖ Tip de debug */}\r\n          {activeVideoCamera && (\r\n            <div className=\"text-xs text-slate-300 break-all\">\r\n              Stream URL: {getStreamUrl(activeVideoCamera.id)}\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}