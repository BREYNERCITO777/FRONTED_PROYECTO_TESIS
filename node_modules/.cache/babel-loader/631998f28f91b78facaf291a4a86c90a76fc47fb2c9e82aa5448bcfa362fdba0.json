{"ast":null,"code":"// frontend/src/modules/settings/api/settingsService.ts\n\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\nasync function http(url, options) {\n  var _ref;\n  const res = await fetch(url, options);\n  const text = await res.text();\n  let data = null;\n  try {\n    data = text ? JSON.parse(text) : null;\n  } catch {\n    data = text || null;\n  }\n  if (!res.ok) {\n    const msg = typeof data === \"object\" && data && \"detail\" in data && data.detail || typeof data === \"object\" && data && \"message\" in data && data.message || `HTTP ${res.status} ${res.statusText}`;\n    throw new Error(msg);\n  }\n  return (_ref = data) !== null && _ref !== void 0 ? _ref : {};\n}\nexport async function getSettings() {\n  return http(`${API_BASE}/settings`);\n}\n\n/**\r\n * ✅ TU BACKEND ES PATCH /settings (según /docs)\r\n */\nexport async function updateSettings(payload) {\n  return http(`${API_BASE}/settings`, {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(payload)\n  });\n}","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","http","url","options","_ref","res","fetch","text","data","JSON","parse","ok","msg","detail","message","status","statusText","Error","getSettings","updateSettings","payload","method","headers","body","stringify"],"sources":["D:/PROYECTO DE TESIS AÑO 2026/sistema-armas/frontend/src/modules/settings/api/settingsService.ts"],"sourcesContent":["// frontend/src/modules/settings/api/settingsService.ts\r\n\r\nconst API_BASE =\r\n  process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\r\n\r\nexport type SystemSettings = {\r\n  confidence_threshold: number; // 0.75\r\n  auto_alert: boolean;\r\n  email_notifications: boolean;\r\n  sound_alerts: boolean;\r\n  save_evidence: boolean;\r\n  max_fps: number; // 30\r\n  infer_every_n_frames: number; // 5\r\n  updated_at?: string;\r\n};\r\n\r\ntype ApiErrorShape = { detail?: string; message?: string } | string | null;\r\n\r\nasync function http<T>(url: string, options?: RequestInit): Promise<T> {\r\n  const res = await fetch(url, options);\r\n\r\n  const text = await res.text();\r\n  let data: ApiErrorShape = null;\r\n\r\n  try {\r\n    data = text ? JSON.parse(text) : null;\r\n  } catch {\r\n    data = text || null;\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const msg =\r\n      (typeof data === \"object\" && data && (\"detail\" in data) && data.detail) ||\r\n      (typeof data === \"object\" && data && (\"message\" in data) && data.message) ||\r\n      `HTTP ${res.status} ${res.statusText}`;\r\n    throw new Error(msg);\r\n  }\r\n\r\n  return (data as T) ?? ({} as T);\r\n}\r\n\r\nexport async function getSettings(): Promise<SystemSettings> {\r\n  return http<SystemSettings>(`${API_BASE}/settings`);\r\n}\r\n\r\n/**\r\n * ✅ TU BACKEND ES PATCH /settings (según /docs)\r\n */\r\nexport async function updateSettings(\r\n  payload: Partial<SystemSettings>\r\n): Promise<SystemSettings> {\r\n  return http<SystemSettings>(`${API_BASE}/settings`, {\r\n    method: \"PATCH\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(payload),\r\n  });\r\n}"],"mappings":"AAAA;;AAEA,MAAMA,QAAQ,GACZC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,8BAA8B;AAelE,eAAeC,IAAIA,CAAIC,GAAW,EAAEC,OAAqB,EAAc;EAAA,IAAAC,IAAA;EACrE,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAACJ,GAAG,EAAEC,OAAO,CAAC;EAErC,MAAMI,IAAI,GAAG,MAAMF,GAAG,CAACE,IAAI,CAAC,CAAC;EAC7B,IAAIC,IAAmB,GAAG,IAAI;EAE9B,IAAI;IACFA,IAAI,GAAGD,IAAI,GAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,IAAI;EACvC,CAAC,CAAC,MAAM;IACNC,IAAI,GAAGD,IAAI,IAAI,IAAI;EACrB;EAEA,IAAI,CAACF,GAAG,CAACM,EAAE,EAAE;IACX,MAAMC,GAAG,GACN,OAAOJ,IAAI,KAAK,QAAQ,IAAIA,IAAI,IAAK,QAAQ,IAAIA,IAAK,IAAIA,IAAI,CAACK,MAAM,IACrE,OAAOL,IAAI,KAAK,QAAQ,IAAIA,IAAI,IAAK,SAAS,IAAIA,IAAK,IAAIA,IAAI,CAACM,OAAQ,IACzE,QAAQT,GAAG,CAACU,MAAM,IAAIV,GAAG,CAACW,UAAU,EAAE;IACxC,MAAM,IAAIC,KAAK,CAACL,GAAG,CAAC;EACtB;EAEA,QAAAR,IAAA,GAAQI,IAAI,cAAAJ,IAAA,cAAAA,IAAA,GAAW,CAAC,CAAC;AAC3B;AAEA,OAAO,eAAec,WAAWA,CAAA,EAA4B;EAC3D,OAAOjB,IAAI,CAAiB,GAAGJ,QAAQ,WAAW,CAAC;AACrD;;AAEA;AACA;AACA;AACA,OAAO,eAAesB,cAAcA,CAClCC,OAAgC,EACP;EACzB,OAAOnB,IAAI,CAAiB,GAAGJ,QAAQ,WAAW,EAAE;IAClDwB,MAAM,EAAE,OAAO;IACfC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEd,IAAI,CAACe,SAAS,CAACJ,OAAO;EAC9B,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}