{"ast":null,"code":"import _objectSpread from\"D:/PROYECTO DE TESIS A\\xD1O 2026/sistema-armas/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// frontend/src/modules/settings/api/settingsService.ts\nconst API_BASE=process.env.REACT_APP_API_BASE||\"http://localhost:8000/api/v1\";function getToken(){return localStorage.getItem(\"token\");}async function http(url){var _ref;let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const token=getToken();const headers=new Headers(options.headers||{});if(!headers.has(\"Content-Type\")&&options.body){headers.set(\"Content-Type\",\"application/json\");}if(token){headers.set(\"Authorization\",\"Bearer \".concat(token));}const res=await fetch(url,_objectSpread(_objectSpread({},options),{},{headers}));const text=await res.text();let data=null;try{data=text?JSON.parse(text):null;}catch(_unused){data=text||null;}if(!res.ok){const msg=typeof data===\"object\"&&data&&\"detail\"in data&&data.detail||typeof data===\"object\"&&data&&\"message\"in data&&data.message||\"HTTP \".concat(res.status,\" \").concat(res.statusText);throw new Error(msg);}return(_ref=data)!==null&&_ref!==void 0?_ref:{};}export async function getSettings(){return http(\"\".concat(API_BASE,\"/settings\"),{method:\"GET\"});}export async function updateSettings(payload){return http(\"\".concat(API_BASE,\"/settings\"),{method:\"PATCH\",body:JSON.stringify(payload)});}","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","getToken","localStorage","getItem","http","url","_ref","options","arguments","length","undefined","token","headers","Headers","has","body","set","concat","res","fetch","_objectSpread","text","data","JSON","parse","_unused","ok","msg","detail","message","status","statusText","Error","getSettings","method","updateSettings","payload","stringify"],"sources":["D:/PROYECTO DE TESIS AÃ‘O 2026/sistema-armas/frontend/src/modules/settings/api/settingsService.ts"],"sourcesContent":["// frontend/src/modules/settings/api/settingsService.ts\r\n\r\nconst API_BASE =\r\n  process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\r\n\r\nexport type SystemSettings = {\r\n  confidence_threshold: number;\r\n  auto_alert: boolean;\r\n  email_notifications: boolean;\r\n  sound_alerts: boolean;\r\n  save_evidence: boolean;\r\n  max_fps: number;\r\n  infer_every_n_frames: number;\r\n  updated_at?: string;\r\n};\r\n\r\ntype ApiErrorShape = { detail?: string; message?: string } | string | null;\r\n\r\nfunction getToken() {\r\n  return localStorage.getItem(\"token\");\r\n}\r\n\r\nasync function http<T>(url: string, options: RequestInit = {}): Promise<T> {\r\n  const token = getToken();\r\n\r\n  const headers = new Headers(options.headers || {});\r\n  if (!headers.has(\"Content-Type\") && options.body) {\r\n    headers.set(\"Content-Type\", \"application/json\");\r\n  }\r\n  if (token) {\r\n    headers.set(\"Authorization\", `Bearer ${token}`);\r\n  }\r\n\r\n  const res = await fetch(url, { ...options, headers });\r\n\r\n  const text = await res.text();\r\n  let data: ApiErrorShape = null;\r\n\r\n  try {\r\n    data = text ? JSON.parse(text) : null;\r\n  } catch {\r\n    data = text || null;\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const msg =\r\n      (typeof data === \"object\" && data && \"detail\" in data && (data as any).detail) ||\r\n      (typeof data === \"object\" && data && \"message\" in data && (data as any).message) ||\r\n      `HTTP ${res.status} ${res.statusText}`;\r\n    throw new Error(msg);\r\n  }\r\n\r\n  return (data as T) ?? ({} as T);\r\n}\r\n\r\nexport async function getSettings(): Promise<SystemSettings> {\r\n  return http<SystemSettings>(`${API_BASE}/settings`, { method: \"GET\" });\r\n}\r\n\r\nexport async function updateSettings(\r\n  payload: Partial<SystemSettings>\r\n): Promise<SystemSettings> {\r\n  return http<SystemSettings>(`${API_BASE}/settings`, {\r\n    method: \"PATCH\",\r\n    body: JSON.stringify(payload),\r\n  });\r\n}"],"mappings":"4IAAA;AAEA,KAAM,CAAAA,QAAQ,CACZC,OAAO,CAACC,GAAG,CAACC,kBAAkB,EAAI,8BAA8B,CAelE,QAAS,CAAAC,QAAQA,CAAA,CAAG,CAClB,MAAO,CAAAC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CACtC,CAEA,cAAe,CAAAC,IAAIA,CAAIC,GAAW,CAAyC,KAAAC,IAAA,IAAvC,CAAAC,OAAoB,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAC3D,KAAM,CAAAG,KAAK,CAAGV,QAAQ,CAAC,CAAC,CAExB,KAAM,CAAAW,OAAO,CAAG,GAAI,CAAAC,OAAO,CAACN,OAAO,CAACK,OAAO,EAAI,CAAC,CAAC,CAAC,CAClD,GAAI,CAACA,OAAO,CAACE,GAAG,CAAC,cAAc,CAAC,EAAIP,OAAO,CAACQ,IAAI,CAAE,CAChDH,OAAO,CAACI,GAAG,CAAC,cAAc,CAAE,kBAAkB,CAAC,CACjD,CACA,GAAIL,KAAK,CAAE,CACTC,OAAO,CAACI,GAAG,CAAC,eAAe,WAAAC,MAAA,CAAYN,KAAK,CAAE,CAAC,CACjD,CAEA,KAAM,CAAAO,GAAG,CAAG,KAAM,CAAAC,KAAK,CAACd,GAAG,CAAAe,aAAA,CAAAA,aAAA,IAAOb,OAAO,MAAEK,OAAO,EAAE,CAAC,CAErD,KAAM,CAAAS,IAAI,CAAG,KAAM,CAAAH,GAAG,CAACG,IAAI,CAAC,CAAC,CAC7B,GAAI,CAAAC,IAAmB,CAAG,IAAI,CAE9B,GAAI,CACFA,IAAI,CAAGD,IAAI,CAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,CAAG,IAAI,CACvC,CAAE,MAAAI,OAAA,CAAM,CACNH,IAAI,CAAGD,IAAI,EAAI,IAAI,CACrB,CAEA,GAAI,CAACH,GAAG,CAACQ,EAAE,CAAE,CACX,KAAM,CAAAC,GAAG,CACN,MAAO,CAAAL,IAAI,GAAK,QAAQ,EAAIA,IAAI,EAAI,QAAQ,EAAI,CAAAA,IAAI,EAAKA,IAAI,CAASM,MAAM,EAC5E,MAAO,CAAAN,IAAI,GAAK,QAAQ,EAAIA,IAAI,EAAI,SAAS,EAAI,CAAAA,IAAI,EAAKA,IAAI,CAASO,OAAQ,UAAAZ,MAAA,CACxEC,GAAG,CAACY,MAAM,MAAAb,MAAA,CAAIC,GAAG,CAACa,UAAU,CAAE,CACxC,KAAM,IAAI,CAAAC,KAAK,CAACL,GAAG,CAAC,CACtB,CAEA,OAAArB,IAAA,CAAQgB,IAAI,UAAAhB,IAAA,UAAAA,IAAA,CAAW,CAAC,CAAC,CAC3B,CAEA,MAAO,eAAe,CAAA2B,WAAWA,CAAA,CAA4B,CAC3D,MAAO,CAAA7B,IAAI,IAAAa,MAAA,CAAoBpB,QAAQ,cAAa,CAAEqC,MAAM,CAAE,KAAM,CAAC,CAAC,CACxE,CAEA,MAAO,eAAe,CAAAC,cAAcA,CAClCC,OAAgC,CACP,CACzB,MAAO,CAAAhC,IAAI,IAAAa,MAAA,CAAoBpB,QAAQ,cAAa,CAClDqC,MAAM,CAAE,OAAO,CACfnB,IAAI,CAAEQ,IAAI,CAACc,SAAS,CAACD,OAAO,CAC9B,CAAC,CAAC,CACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}