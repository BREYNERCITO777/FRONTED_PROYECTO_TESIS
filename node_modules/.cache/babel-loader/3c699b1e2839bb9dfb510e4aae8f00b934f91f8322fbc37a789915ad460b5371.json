{"ast":null,"code":"// frontend/src/api/alerts.ts\nimport{http}from\"./http\";function normalizeSeverity(s){const v=String(s!==null&&s!==void 0?s:\"\").toLowerCase();if(v===\"critical\")return\"critical\";if(v===\"high\")return\"high\";if(v===\"medium\")return\"medium\";return\"low\";}function normalizeConfidence(c){if(c==null)return undefined;const n=Number(c);if(!Number.isFinite(n))return undefined;// por si alguna vez viniera 0-100\nconst val=n>1?n/100:n;return Math.max(0,Math.min(1,val));}export function normalizeAlert(raw){var _ref,_raw$_id,_raw$title,_raw$message,_ref2,_raw$timestamp,_raw$evidence_url;const _id=String((_ref=(_raw$_id=raw._id)!==null&&_raw$_id!==void 0?_raw$_id:raw.id)!==null&&_ref!==void 0?_ref:\"\");return{_id,title:String((_raw$title=raw.title)!==null&&_raw$title!==void 0?_raw$title:\"Alerta\"),message:String((_raw$message=raw.message)!==null&&_raw$message!==void 0?_raw$message:\"\"),camera_id:raw.camera_id!=null?String(raw.camera_id):undefined,weapon_type:raw.weapon_type!=null?String(raw.weapon_type):undefined,confidence:normalizeConfidence(raw.confidence),severity:normalizeSeverity(raw.severity),read:Boolean(raw.read),timestamp:(_ref2=(_raw$timestamp=raw.timestamp)!==null&&_raw$timestamp!==void 0?_raw$timestamp:raw.created_at)!==null&&_ref2!==void 0?_ref2:undefined,evidence_url:(_raw$evidence_url=raw.evidence_url)!==null&&_raw$evidence_url!==void 0?_raw$evidence_url:undefined};}export async function listAlerts(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:50;const{data}=await http.get(\"/alerts?limit=\".concat(limit));const arr=Array.isArray(data)?data:[];return arr.map(normalizeAlert);}export async function markAlertRead(alertId){let read=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;// tu backend: PATCH /alerts/{id}/read?read=true\nconst{data}=await http.patch(\"/alerts/\".concat(alertId,\"/read?read=\").concat(read));return normalizeAlert(data);}export async function deleteAlert(alertId){const{data}=await http.delete(\"/alerts/\".concat(alertId));return data;}","map":{"version":3,"names":["http","normalizeSeverity","s","v","String","toLowerCase","normalizeConfidence","c","undefined","n","Number","isFinite","val","Math","max","min","normalizeAlert","raw","_ref","_raw$_id","_raw$title","_raw$message","_ref2","_raw$timestamp","_raw$evidence_url","_id","id","title","message","camera_id","weapon_type","confidence","severity","read","Boolean","timestamp","created_at","evidence_url","listAlerts","limit","arguments","length","data","get","concat","arr","Array","isArray","map","markAlertRead","alertId","patch","deleteAlert","delete"],"sources":["D:/PROYECTO DE TESIS AÃ‘O 2026/sistema-armas/frontend/src/api/alerts.ts"],"sourcesContent":["// frontend/src/api/alerts.ts\r\nimport { http } from \"./http\";\r\n\r\nexport type AlertOut = {\r\n  _id?: string;\r\n  id?: string;\r\n\r\n  title?: string;\r\n  message?: string;\r\n\r\n  camera_id?: string | number;\r\n  weapon_type?: string;\r\n\r\n  confidence?: number; // 0..1 (tu backend lo manda float)\r\n  severity?: string; // critical | high | medium | low\r\n  read?: boolean;\r\n\r\n  created_at?: string;\r\n  timestamp?: string;\r\n  evidence_url?: string;\r\n};\r\n\r\nexport type AlertUI = {\r\n  _id: string;\r\n  title: string;\r\n  message: string;\r\n  camera_id?: string;\r\n  weapon_type?: string;\r\n  confidence?: number; // 0..1\r\n  severity: \"critical\" | \"high\" | \"medium\" | \"low\";\r\n  read: boolean;\r\n  timestamp?: string;\r\n  evidence_url?: string;\r\n};\r\n\r\nfunction normalizeSeverity(s?: string): AlertUI[\"severity\"] {\r\n  const v = String(s ?? \"\").toLowerCase();\r\n  if (v === \"critical\") return \"critical\";\r\n  if (v === \"high\") return \"high\";\r\n  if (v === \"medium\") return \"medium\";\r\n  return \"low\";\r\n}\r\n\r\nfunction normalizeConfidence(c?: number): number | undefined {\r\n  if (c == null) return undefined;\r\n  const n = Number(c);\r\n  if (!Number.isFinite(n)) return undefined;\r\n  // por si alguna vez viniera 0-100\r\n  const val = n > 1 ? n / 100 : n;\r\n  return Math.max(0, Math.min(1, val));\r\n}\r\n\r\nexport function normalizeAlert(raw: any): AlertUI {\r\n  const _id = String(raw._id ?? raw.id ?? \"\");\r\n  return {\r\n    _id,\r\n    title: String(raw.title ?? \"Alerta\"),\r\n    message: String(raw.message ?? \"\"),\r\n    camera_id: raw.camera_id != null ? String(raw.camera_id) : undefined,\r\n    weapon_type: raw.weapon_type != null ? String(raw.weapon_type) : undefined,\r\n    confidence: normalizeConfidence(raw.confidence),\r\n    severity: normalizeSeverity(raw.severity),\r\n    read: Boolean(raw.read),\r\n    timestamp: raw.timestamp ?? raw.created_at ?? undefined,\r\n    evidence_url: raw.evidence_url ?? undefined,\r\n  };\r\n}\r\n\r\nexport async function listAlerts(limit = 50): Promise<AlertUI[]> {\r\n  const { data } = await http.get<AlertOut[]>(`/alerts?limit=${limit}`);\r\n  const arr = Array.isArray(data) ? data : [];\r\n  return arr.map(normalizeAlert);\r\n}\r\n\r\nexport async function markAlertRead(alertId: string, read = true): Promise<AlertUI> {\r\n  // tu backend: PATCH /alerts/{id}/read?read=true\r\n  const { data } = await http.patch<AlertOut>(`/alerts/${alertId}/read?read=${read}`);\r\n  return normalizeAlert(data);\r\n}\r\n\r\nexport async function deleteAlert(alertId: string): Promise<{ deleted: boolean; alert_id: string }> {\r\n  const { data } = await http.delete(`/alerts/${alertId}`);\r\n  return data;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}