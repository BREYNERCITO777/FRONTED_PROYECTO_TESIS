{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROYECTO DE TESIS A\\xD1O 2026\\\\sistema-armas\\\\frontend\\\\src\\\\app\\\\providers\\\\alerts-context.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// frontend/src/app/providers/alerts-context.tsx\nimport React, { createContext, useContext, useEffect, useMemo, useRef, useState, useCallback } from \"react\";\nimport { http } from \"../../api/http\"; // axios con Bearer automático\nimport { useAuth } from \"../../context/auth-context\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AlertsContext = /*#__PURE__*/createContext(null);\nfunction normalizeSeverity(s) {\n  const v = String(s !== null && s !== void 0 ? s : \"medium\").toLowerCase();\n  if (v === \"critical\") return \"critical\";\n  if (v === \"high\") return \"high\";\n  if (v === \"medium\") return \"medium\";\n  return \"low\";\n}\nfunction normalizeConfidence(c) {\n  if (c == null) return null;\n  const n = Number(c);\n  if (!Number.isFinite(n)) return null;\n  const v = n > 1 ? n / 100 : n; // por si viniera 0..100\n  return Math.max(0, Math.min(1, v));\n}\nfunction normalizeAlert(a) {\n  var _ref, _a$_id, _a$type, _a$title, _a$message, _a$weapon_type, _a$evidence_url, _a$camera_id, _ref2, _a$timestamp;\n  return {\n    _id: String((_ref = (_a$_id = a._id) !== null && _a$_id !== void 0 ? _a$_id : a.id) !== null && _ref !== void 0 ? _ref : \"\"),\n    type: (_a$type = a.type) !== null && _a$type !== void 0 ? _a$type : \"ALERTA\",\n    title: (_a$title = a.title) !== null && _a$title !== void 0 ? _a$title : \"Detección\",\n    message: (_a$message = a.message) !== null && _a$message !== void 0 ? _a$message : \"\",\n    severity: normalizeSeverity(a.severity),\n    weapon_type: (_a$weapon_type = a.weapon_type) !== null && _a$weapon_type !== void 0 ? _a$weapon_type : null,\n    confidence: normalizeConfidence(a.confidence),\n    evidence_url: (_a$evidence_url = a.evidence_url) !== null && _a$evidence_url !== void 0 ? _a$evidence_url : null,\n    camera_id: (_a$camera_id = a.camera_id) !== null && _a$camera_id !== void 0 ? _a$camera_id : null,\n    timestamp: (_ref2 = (_a$timestamp = a.timestamp) !== null && _a$timestamp !== void 0 ? _a$timestamp : a.created_at) !== null && _ref2 !== void 0 ? _ref2 : null,\n    read: !!a.read\n  };\n}\nexport function AlertsProvider({\n  children\n}) {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const isAdmin = (user === null || user === void 0 ? void 0 : user.role) === \"admin\";\n  const [alerts, setAlerts] = useState([]);\n  const pollRef = useRef(null);\n  const refresh = useCallback(async () => {\n    if (!user) return;\n    const {\n      data\n    } = await http.get(`/alerts?limit=200`);\n    const arr = (Array.isArray(data) ? data : []).map(normalizeAlert);\n\n    // ordenar desc por timestamp (ISO string)\n    arr.sort((a, b) => {\n      var _b$timestamp, _a$timestamp2;\n      return String((_b$timestamp = b.timestamp) !== null && _b$timestamp !== void 0 ? _b$timestamp : \"\").localeCompare(String((_a$timestamp2 = a.timestamp) !== null && _a$timestamp2 !== void 0 ? _a$timestamp2 : \"\"));\n    });\n    setAlerts(arr);\n  }, [user]);\n  const markAsRead = useCallback(async id => {\n    setAlerts(prev => prev.map(a => a._id === id ? {\n      ...a,\n      read: true\n    } : a));\n    try {\n      await http.patch(`/alerts/${id}/read?read=true`);\n    } catch (e) {\n      setAlerts(prev => prev.map(a => a._id === id ? {\n        ...a,\n        read: false\n      } : a));\n      throw e;\n    }\n  }, []);\n  const markAllAsRead = useCallback(async () => {\n    const unreadIds = alerts.filter(a => !a.read).map(a => a._id);\n    if (unreadIds.length === 0) return;\n    setAlerts(prev => prev.map(a => ({\n      ...a,\n      read: true\n    })));\n    try {\n      await Promise.all(unreadIds.map(id => http.patch(`/alerts/${id}/read?read=true`)));\n    } catch (e) {\n      await refresh();\n      throw e;\n    }\n  }, [alerts, refresh]);\n  const deleteAlert = useCallback(async id => {\n    if (!isAdmin) throw new Error(\"No tienes permisos para eliminar alertas\");\n    const prev = alerts;\n    setAlerts(p => p.filter(a => a._id !== id));\n    try {\n      await http.delete(`/alerts/${id}`);\n    } catch (e) {\n      setAlerts(prev);\n      throw e;\n    }\n  }, [alerts, isAdmin]);\n  const unreadCount = useMemo(() => alerts.filter(a => !a.read).length, [alerts]);\n\n  // ✅ Polling: cada 5s (solo con sesión)\n  useEffect(() => {\n    // sin sesión => limpiar y parar polling\n    if (!user) {\n      setAlerts([]);\n      if (pollRef.current) window.clearInterval(pollRef.current);\n      pollRef.current = null;\n      return;\n    }\n\n    // primer load\n    refresh().catch(console.error);\n\n    // intervalo\n    if (pollRef.current) window.clearInterval(pollRef.current);\n    pollRef.current = window.setInterval(() => {\n      refresh().catch(() => {});\n    }, 5000);\n    return () => {\n      if (pollRef.current) window.clearInterval(pollRef.current);\n      pollRef.current = null;\n    };\n  }, [user === null || user === void 0 ? void 0 : user._id, refresh]);\n\n  // ✅ refrescar cuando vuelves a la pestaña\n  useEffect(() => {\n    const onVis = () => {\n      if (document.visibilityState === \"visible\") {\n        refresh().catch(() => {});\n      }\n    };\n    document.addEventListener(\"visibilitychange\", onVis);\n    return () => document.removeEventListener(\"visibilitychange\", onVis);\n  }, [refresh]);\n  return /*#__PURE__*/_jsxDEV(AlertsContext.Provider, {\n    value: {\n      alerts,\n      unreadCount,\n      refresh,\n      markAsRead,\n      markAllAsRead,\n      deleteAlert\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 173,\n    columnNumber: 5\n  }, this);\n}\n_s(AlertsProvider, \"5ntGLMl9pe9BxKOh4Sq/qiuwMFI=\", false, function () {\n  return [useAuth];\n});\n_c = AlertsProvider;\nexport function useAlerts() {\n  _s2();\n  const ctx = useContext(AlertsContext);\n  if (!ctx) throw new Error(\"useAlerts debe usarse dentro de <AlertsProvider/>\");\n  return ctx;\n}\n_s2(useAlerts, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nvar _c;\n$RefreshReg$(_c, \"AlertsProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useMemo","useRef","useState","useCallback","http","useAuth","jsxDEV","_jsxDEV","AlertsContext","normalizeSeverity","s","v","String","toLowerCase","normalizeConfidence","c","n","Number","isFinite","Math","max","min","normalizeAlert","a","_ref","_a$_id","_a$type","_a$title","_a$message","_a$weapon_type","_a$evidence_url","_a$camera_id","_ref2","_a$timestamp","_id","id","type","title","message","severity","weapon_type","confidence","evidence_url","camera_id","timestamp","created_at","read","AlertsProvider","children","_s","user","isAdmin","role","alerts","setAlerts","pollRef","refresh","data","get","arr","Array","isArray","map","sort","b","_b$timestamp","_a$timestamp2","localeCompare","markAsRead","prev","patch","e","markAllAsRead","unreadIds","filter","length","Promise","all","deleteAlert","Error","p","delete","unreadCount","current","window","clearInterval","catch","console","error","setInterval","onVis","document","visibilityState","addEventListener","removeEventListener","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAlerts","_s2","ctx","$RefreshReg$"],"sources":["D:/PROYECTO DE TESIS AÑO 2026/sistema-armas/frontend/src/app/providers/alerts-context.tsx"],"sourcesContent":["// frontend/src/app/providers/alerts-context.tsx\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n  useCallback,\r\n} from \"react\";\r\nimport { http } from \"../../api/http\"; // axios con Bearer automático\r\nimport { useAuth } from \"../../context/auth-context\";\r\n\r\ntype Severity = \"critical\" | \"high\" | \"medium\" | \"low\";\r\n\r\nexport interface AlertApi {\r\n  _id: string;\r\n  type?: string;\r\n  title: string;\r\n  message: string;\r\n  severity: Severity;\r\n  weapon_type?: string | null;\r\n  confidence?: number | null;\r\n  evidence_url?: string | null;\r\n  camera_id?: string | null;\r\n  timestamp?: string | null;\r\n  read?: boolean;\r\n}\r\n\r\ntype AlertsContextValue = {\r\n  alerts: AlertApi[];\r\n  unreadCount: number;\r\n  refresh: () => Promise<void>;\r\n  markAsRead: (id: string) => Promise<void>;\r\n  markAllAsRead: () => Promise<void>;\r\n  deleteAlert: (id: string) => Promise<void>; // solo admin (backend valida igual)\r\n};\r\n\r\nconst AlertsContext = createContext<AlertsContextValue | null>(null);\r\n\r\nfunction normalizeSeverity(s: any): Severity {\r\n  const v = String(s ?? \"medium\").toLowerCase();\r\n  if (v === \"critical\") return \"critical\";\r\n  if (v === \"high\") return \"high\";\r\n  if (v === \"medium\") return \"medium\";\r\n  return \"low\";\r\n}\r\n\r\nfunction normalizeConfidence(c: any): number | null {\r\n  if (c == null) return null;\r\n  const n = Number(c);\r\n  if (!Number.isFinite(n)) return null;\r\n  const v = n > 1 ? n / 100 : n; // por si viniera 0..100\r\n  return Math.max(0, Math.min(1, v));\r\n}\r\n\r\nfunction normalizeAlert(a: any): AlertApi {\r\n  return {\r\n    _id: String(a._id ?? a.id ?? \"\"),\r\n    type: a.type ?? \"ALERTA\",\r\n    title: a.title ?? \"Detección\",\r\n    message: a.message ?? \"\",\r\n    severity: normalizeSeverity(a.severity),\r\n    weapon_type: a.weapon_type ?? null,\r\n    confidence: normalizeConfidence(a.confidence),\r\n    evidence_url: a.evidence_url ?? null,\r\n    camera_id: a.camera_id ?? null,\r\n    timestamp: a.timestamp ?? a.created_at ?? null,\r\n    read: !!a.read,\r\n  };\r\n}\r\n\r\nexport function AlertsProvider({ children }: { children: React.ReactNode }) {\r\n  const { user } = useAuth();\r\n  const isAdmin = user?.role === \"admin\";\r\n\r\n  const [alerts, setAlerts] = useState<AlertApi[]>([]);\r\n  const pollRef = useRef<number | null>(null);\r\n\r\n  const refresh = useCallback(async () => {\r\n    if (!user) return;\r\n    const { data } = await http.get(`/alerts?limit=200`);\r\n    const arr = (Array.isArray(data) ? data : []).map(normalizeAlert);\r\n\r\n    // ordenar desc por timestamp (ISO string)\r\n    arr.sort((a: AlertApi, b: AlertApi) =>\r\n      String(b.timestamp ?? \"\").localeCompare(String(a.timestamp ?? \"\"))\r\n    );\r\n\r\n    setAlerts(arr);\r\n  }, [user]);\r\n\r\n  const markAsRead = useCallback(async (id: string) => {\r\n    setAlerts((prev) => prev.map((a) => (a._id === id ? { ...a, read: true } : a)));\r\n    try {\r\n      await http.patch(`/alerts/${id}/read?read=true`);\r\n    } catch (e) {\r\n      setAlerts((prev) => prev.map((a) => (a._id === id ? { ...a, read: false } : a)));\r\n      throw e;\r\n    }\r\n  }, []);\r\n\r\n  const markAllAsRead = useCallback(async () => {\r\n    const unreadIds = alerts.filter((a) => !a.read).map((a) => a._id);\r\n    if (unreadIds.length === 0) return;\r\n\r\n    setAlerts((prev) => prev.map((a) => ({ ...a, read: true })));\r\n\r\n    try {\r\n      await Promise.all(unreadIds.map((id) => http.patch(`/alerts/${id}/read?read=true`)));\r\n    } catch (e) {\r\n      await refresh();\r\n      throw e;\r\n    }\r\n  }, [alerts, refresh]);\r\n\r\n  const deleteAlert = useCallback(\r\n    async (id: string) => {\r\n      if (!isAdmin) throw new Error(\"No tienes permisos para eliminar alertas\");\r\n\r\n      const prev = alerts;\r\n      setAlerts((p) => p.filter((a) => a._id !== id));\r\n\r\n      try {\r\n        await http.delete(`/alerts/${id}`);\r\n      } catch (e) {\r\n        setAlerts(prev);\r\n        throw e;\r\n      }\r\n    },\r\n    [alerts, isAdmin]\r\n  );\r\n\r\n  const unreadCount = useMemo(() => alerts.filter((a) => !a.read).length, [alerts]);\r\n\r\n  // ✅ Polling: cada 5s (solo con sesión)\r\n  useEffect(() => {\r\n    // sin sesión => limpiar y parar polling\r\n    if (!user) {\r\n      setAlerts([]);\r\n      if (pollRef.current) window.clearInterval(pollRef.current);\r\n      pollRef.current = null;\r\n      return;\r\n    }\r\n\r\n    // primer load\r\n    refresh().catch(console.error);\r\n\r\n    // intervalo\r\n    if (pollRef.current) window.clearInterval(pollRef.current);\r\n    pollRef.current = window.setInterval(() => {\r\n      refresh().catch(() => {});\r\n    }, 5000);\r\n\r\n    return () => {\r\n      if (pollRef.current) window.clearInterval(pollRef.current);\r\n      pollRef.current = null;\r\n    };\r\n  }, [user?._id, refresh]);\r\n\r\n  // ✅ refrescar cuando vuelves a la pestaña\r\n  useEffect(() => {\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") {\r\n        refresh().catch(() => {});\r\n      }\r\n    };\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n    return () => document.removeEventListener(\"visibilitychange\", onVis);\r\n  }, [refresh]);\r\n\r\n  return (\r\n    <AlertsContext.Provider\r\n      value={{ alerts, unreadCount, refresh, markAsRead, markAllAsRead, deleteAlert }}\r\n    >\r\n      {children}\r\n    </AlertsContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAlerts() {\r\n  const ctx = useContext(AlertsContext);\r\n  if (!ctx) throw new Error(\"useAlerts debe usarse dentro de <AlertsProvider/>\");\r\n  return ctx;\r\n}"],"mappings":";;;AAAA;AACA,OAAOA,KAAK,IACVC,aAAa,EACbC,UAAU,EACVC,SAAS,EACTC,OAAO,EACPC,MAAM,EACNC,QAAQ,EACRC,WAAW,QACN,OAAO;AACd,SAASC,IAAI,QAAQ,gBAAgB,CAAC,CAAC;AACvC,SAASC,OAAO,QAAQ,4BAA4B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AA2BrD,MAAMC,aAAa,gBAAGX,aAAa,CAA4B,IAAI,CAAC;AAEpE,SAASY,iBAAiBA,CAACC,CAAM,EAAY;EAC3C,MAAMC,CAAC,GAAGC,MAAM,CAACF,CAAC,aAADA,CAAC,cAADA,CAAC,GAAI,QAAQ,CAAC,CAACG,WAAW,CAAC,CAAC;EAC7C,IAAIF,CAAC,KAAK,UAAU,EAAE,OAAO,UAAU;EACvC,IAAIA,CAAC,KAAK,MAAM,EAAE,OAAO,MAAM;EAC/B,IAAIA,CAAC,KAAK,QAAQ,EAAE,OAAO,QAAQ;EACnC,OAAO,KAAK;AACd;AAEA,SAASG,mBAAmBA,CAACC,CAAM,EAAiB;EAClD,IAAIA,CAAC,IAAI,IAAI,EAAE,OAAO,IAAI;EAC1B,MAAMC,CAAC,GAAGC,MAAM,CAACF,CAAC,CAAC;EACnB,IAAI,CAACE,MAAM,CAACC,QAAQ,CAACF,CAAC,CAAC,EAAE,OAAO,IAAI;EACpC,MAAML,CAAC,GAAGK,CAAC,GAAG,CAAC,GAAGA,CAAC,GAAG,GAAG,GAAGA,CAAC,CAAC,CAAC;EAC/B,OAAOG,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEV,CAAC,CAAC,CAAC;AACpC;AAEA,SAASW,cAAcA,CAACC,CAAM,EAAY;EAAA,IAAAC,IAAA,EAAAC,MAAA,EAAAC,OAAA,EAAAC,QAAA,EAAAC,UAAA,EAAAC,cAAA,EAAAC,eAAA,EAAAC,YAAA,EAAAC,KAAA,EAAAC,YAAA;EACxC,OAAO;IACLC,GAAG,EAAEtB,MAAM,EAAAY,IAAA,IAAAC,MAAA,GAACF,CAAC,CAACW,GAAG,cAAAT,MAAA,cAAAA,MAAA,GAAIF,CAAC,CAACY,EAAE,cAAAX,IAAA,cAAAA,IAAA,GAAI,EAAE,CAAC;IAChCY,IAAI,GAAAV,OAAA,GAAEH,CAAC,CAACa,IAAI,cAAAV,OAAA,cAAAA,OAAA,GAAI,QAAQ;IACxBW,KAAK,GAAAV,QAAA,GAAEJ,CAAC,CAACc,KAAK,cAAAV,QAAA,cAAAA,QAAA,GAAI,WAAW;IAC7BW,OAAO,GAAAV,UAAA,GAAEL,CAAC,CAACe,OAAO,cAAAV,UAAA,cAAAA,UAAA,GAAI,EAAE;IACxBW,QAAQ,EAAE9B,iBAAiB,CAACc,CAAC,CAACgB,QAAQ,CAAC;IACvCC,WAAW,GAAAX,cAAA,GAAEN,CAAC,CAACiB,WAAW,cAAAX,cAAA,cAAAA,cAAA,GAAI,IAAI;IAClCY,UAAU,EAAE3B,mBAAmB,CAACS,CAAC,CAACkB,UAAU,CAAC;IAC7CC,YAAY,GAAAZ,eAAA,GAAEP,CAAC,CAACmB,YAAY,cAAAZ,eAAA,cAAAA,eAAA,GAAI,IAAI;IACpCa,SAAS,GAAAZ,YAAA,GAAER,CAAC,CAACoB,SAAS,cAAAZ,YAAA,cAAAA,YAAA,GAAI,IAAI;IAC9Ba,SAAS,GAAAZ,KAAA,IAAAC,YAAA,GAAEV,CAAC,CAACqB,SAAS,cAAAX,YAAA,cAAAA,YAAA,GAAIV,CAAC,CAACsB,UAAU,cAAAb,KAAA,cAAAA,KAAA,GAAI,IAAI;IAC9Cc,IAAI,EAAE,CAAC,CAACvB,CAAC,CAACuB;EACZ,CAAC;AACH;AAEA,OAAO,SAASC,cAAcA,CAAC;EAAEC;AAAwC,CAAC,EAAE;EAAAC,EAAA;EAC1E,MAAM;IAAEC;EAAK,CAAC,GAAG7C,OAAO,CAAC,CAAC;EAC1B,MAAM8C,OAAO,GAAG,CAAAD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEE,IAAI,MAAK,OAAO;EAEtC,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGpD,QAAQ,CAAa,EAAE,CAAC;EACpD,MAAMqD,OAAO,GAAGtD,MAAM,CAAgB,IAAI,CAAC;EAE3C,MAAMuD,OAAO,GAAGrD,WAAW,CAAC,YAAY;IACtC,IAAI,CAAC+C,IAAI,EAAE;IACX,MAAM;MAAEO;IAAK,CAAC,GAAG,MAAMrD,IAAI,CAACsD,GAAG,CAAC,mBAAmB,CAAC;IACpD,MAAMC,GAAG,GAAG,CAACC,KAAK,CAACC,OAAO,CAACJ,IAAI,CAAC,GAAGA,IAAI,GAAG,EAAE,EAAEK,GAAG,CAACxC,cAAc,CAAC;;IAEjE;IACAqC,GAAG,CAACI,IAAI,CAAC,CAACxC,CAAW,EAAEyC,CAAW;MAAA,IAAAC,YAAA,EAAAC,aAAA;MAAA,OAChCtD,MAAM,EAAAqD,YAAA,GAACD,CAAC,CAACpB,SAAS,cAAAqB,YAAA,cAAAA,YAAA,GAAI,EAAE,CAAC,CAACE,aAAa,CAACvD,MAAM,EAAAsD,aAAA,GAAC3C,CAAC,CAACqB,SAAS,cAAAsB,aAAA,cAAAA,aAAA,GAAI,EAAE,CAAC,CAAC;IAAA,CACpE,CAAC;IAEDZ,SAAS,CAACK,GAAG,CAAC;EAChB,CAAC,EAAE,CAACT,IAAI,CAAC,CAAC;EAEV,MAAMkB,UAAU,GAAGjE,WAAW,CAAC,MAAOgC,EAAU,IAAK;IACnDmB,SAAS,CAAEe,IAAI,IAAKA,IAAI,CAACP,GAAG,CAAEvC,CAAC,IAAMA,CAAC,CAACW,GAAG,KAAKC,EAAE,GAAG;MAAE,GAAGZ,CAAC;MAAEuB,IAAI,EAAE;IAAK,CAAC,GAAGvB,CAAE,CAAC,CAAC;IAC/E,IAAI;MACF,MAAMnB,IAAI,CAACkE,KAAK,CAAC,WAAWnC,EAAE,iBAAiB,CAAC;IAClD,CAAC,CAAC,OAAOoC,CAAC,EAAE;MACVjB,SAAS,CAAEe,IAAI,IAAKA,IAAI,CAACP,GAAG,CAAEvC,CAAC,IAAMA,CAAC,CAACW,GAAG,KAAKC,EAAE,GAAG;QAAE,GAAGZ,CAAC;QAAEuB,IAAI,EAAE;MAAM,CAAC,GAAGvB,CAAE,CAAC,CAAC;MAChF,MAAMgD,CAAC;IACT;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,aAAa,GAAGrE,WAAW,CAAC,YAAY;IAC5C,MAAMsE,SAAS,GAAGpB,MAAM,CAACqB,MAAM,CAAEnD,CAAC,IAAK,CAACA,CAAC,CAACuB,IAAI,CAAC,CAACgB,GAAG,CAAEvC,CAAC,IAAKA,CAAC,CAACW,GAAG,CAAC;IACjE,IAAIuC,SAAS,CAACE,MAAM,KAAK,CAAC,EAAE;IAE5BrB,SAAS,CAAEe,IAAI,IAAKA,IAAI,CAACP,GAAG,CAAEvC,CAAC,KAAM;MAAE,GAAGA,CAAC;MAAEuB,IAAI,EAAE;IAAK,CAAC,CAAC,CAAC,CAAC;IAE5D,IAAI;MACF,MAAM8B,OAAO,CAACC,GAAG,CAACJ,SAAS,CAACX,GAAG,CAAE3B,EAAE,IAAK/B,IAAI,CAACkE,KAAK,CAAC,WAAWnC,EAAE,iBAAiB,CAAC,CAAC,CAAC;IACtF,CAAC,CAAC,OAAOoC,CAAC,EAAE;MACV,MAAMf,OAAO,CAAC,CAAC;MACf,MAAMe,CAAC;IACT;EACF,CAAC,EAAE,CAAClB,MAAM,EAAEG,OAAO,CAAC,CAAC;EAErB,MAAMsB,WAAW,GAAG3E,WAAW,CAC7B,MAAOgC,EAAU,IAAK;IACpB,IAAI,CAACgB,OAAO,EAAE,MAAM,IAAI4B,KAAK,CAAC,0CAA0C,CAAC;IAEzE,MAAMV,IAAI,GAAGhB,MAAM;IACnBC,SAAS,CAAE0B,CAAC,IAAKA,CAAC,CAACN,MAAM,CAAEnD,CAAC,IAAKA,CAAC,CAACW,GAAG,KAAKC,EAAE,CAAC,CAAC;IAE/C,IAAI;MACF,MAAM/B,IAAI,CAAC6E,MAAM,CAAC,WAAW9C,EAAE,EAAE,CAAC;IACpC,CAAC,CAAC,OAAOoC,CAAC,EAAE;MACVjB,SAAS,CAACe,IAAI,CAAC;MACf,MAAME,CAAC;IACT;EACF,CAAC,EACD,CAAClB,MAAM,EAAEF,OAAO,CAClB,CAAC;EAED,MAAM+B,WAAW,GAAGlF,OAAO,CAAC,MAAMqD,MAAM,CAACqB,MAAM,CAAEnD,CAAC,IAAK,CAACA,CAAC,CAACuB,IAAI,CAAC,CAAC6B,MAAM,EAAE,CAACtB,MAAM,CAAC,CAAC;;EAEjF;EACAtD,SAAS,CAAC,MAAM;IACd;IACA,IAAI,CAACmD,IAAI,EAAE;MACTI,SAAS,CAAC,EAAE,CAAC;MACb,IAAIC,OAAO,CAAC4B,OAAO,EAAEC,MAAM,CAACC,aAAa,CAAC9B,OAAO,CAAC4B,OAAO,CAAC;MAC1D5B,OAAO,CAAC4B,OAAO,GAAG,IAAI;MACtB;IACF;;IAEA;IACA3B,OAAO,CAAC,CAAC,CAAC8B,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;;IAE9B;IACA,IAAIjC,OAAO,CAAC4B,OAAO,EAAEC,MAAM,CAACC,aAAa,CAAC9B,OAAO,CAAC4B,OAAO,CAAC;IAC1D5B,OAAO,CAAC4B,OAAO,GAAGC,MAAM,CAACK,WAAW,CAAC,MAAM;MACzCjC,OAAO,CAAC,CAAC,CAAC8B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;IAC3B,CAAC,EAAE,IAAI,CAAC;IAER,OAAO,MAAM;MACX,IAAI/B,OAAO,CAAC4B,OAAO,EAAEC,MAAM,CAACC,aAAa,CAAC9B,OAAO,CAAC4B,OAAO,CAAC;MAC1D5B,OAAO,CAAC4B,OAAO,GAAG,IAAI;IACxB,CAAC;EACH,CAAC,EAAE,CAACjC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEhB,GAAG,EAAEsB,OAAO,CAAC,CAAC;;EAExB;EACAzD,SAAS,CAAC,MAAM;IACd,MAAM2F,KAAK,GAAGA,CAAA,KAAM;MAClB,IAAIC,QAAQ,CAACC,eAAe,KAAK,SAAS,EAAE;QAC1CpC,OAAO,CAAC,CAAC,CAAC8B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;MAC3B;IACF,CAAC;IACDK,QAAQ,CAACE,gBAAgB,CAAC,kBAAkB,EAAEH,KAAK,CAAC;IACpD,OAAO,MAAMC,QAAQ,CAACG,mBAAmB,CAAC,kBAAkB,EAAEJ,KAAK,CAAC;EACtE,CAAC,EAAE,CAAClC,OAAO,CAAC,CAAC;EAEb,oBACEjD,OAAA,CAACC,aAAa,CAACuF,QAAQ;IACrBC,KAAK,EAAE;MAAE3C,MAAM;MAAE6B,WAAW;MAAE1B,OAAO;MAAEY,UAAU;MAAEI,aAAa;MAAEM;IAAY,CAAE;IAAA9B,QAAA,EAE/EA;EAAQ;IAAAiD,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACa,CAAC;AAE7B;AAACnD,EAAA,CA1GeF,cAAc;EAAA,QACX1C,OAAO;AAAA;AAAAgG,EAAA,GADVtD,cAAc;AA4G9B,OAAO,SAASuD,SAASA,CAAA,EAAG;EAAAC,GAAA;EAC1B,MAAMC,GAAG,GAAG1G,UAAU,CAACU,aAAa,CAAC;EACrC,IAAI,CAACgG,GAAG,EAAE,MAAM,IAAIzB,KAAK,CAAC,mDAAmD,CAAC;EAC9E,OAAOyB,GAAG;AACZ;AAACD,GAAA,CAJeD,SAAS;AAAA,IAAAD,EAAA;AAAAI,YAAA,CAAAJ,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}