{"ast":null,"code":"// frontend/src/api/http.ts\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\nfunction getToken() {\n  return localStorage.getItem(\"token\");\n}\nexport async function api(path, options = {}) {\n  const token = getToken();\n  const headers = new Headers(options.headers || {});\n  if (!headers.has(\"Content-Type\") && options.body) {\n    headers.set(\"Content-Type\", \"application/json\");\n  }\n  if (token) headers.set(\"Authorization\", `Bearer ${token}`);\n  const res = await fetch(`${API_BASE}${path}`, {\n    ...options,\n    headers\n  });\n  const text = await res.text();\n  let data = null;\n  try {\n    data = text ? JSON.parse(text) : null;\n  } catch {\n    data = text;\n  }\n  if (!res.ok) {\n    const err = {\n      status: res.status,\n      message: data && (data.detail || data.message) || `HTTP ${res.status} ${res.statusText}`,\n      detail: data\n    };\n    throw err;\n  }\n  return data;\n}","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","getToken","localStorage","getItem","api","path","options","token","headers","Headers","has","body","set","res","fetch","text","data","JSON","parse","ok","err","status","message","detail","statusText"],"sources":["D:/PROYECTO DE TESIS AÃ‘O 2026/sistema-armas/frontend/src/api/http.ts"],"sourcesContent":["// frontend/src/api/http.ts\r\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\r\n\r\nexport type HttpError = {\r\n  status: number;\r\n  message: string;\r\n  detail?: any;\r\n};\r\n\r\nfunction getToken() {\r\n  return localStorage.getItem(\"token\");\r\n}\r\n\r\nexport async function api<T>(path: string, options: RequestInit = {}): Promise<T> {\r\n  const token = getToken();\r\n\r\n  const headers = new Headers(options.headers || {});\r\n  if (!headers.has(\"Content-Type\") && options.body) {\r\n    headers.set(\"Content-Type\", \"application/json\");\r\n  }\r\n  if (token) headers.set(\"Authorization\", `Bearer ${token}`);\r\n\r\n  const res = await fetch(`${API_BASE}${path}`, {\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  const text = await res.text();\r\n  let data: any = null;\r\n  try {\r\n    data = text ? JSON.parse(text) : null;\r\n  } catch {\r\n    data = text;\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const err: HttpError = {\r\n      status: res.status,\r\n      message: (data && (data.detail || data.message)) || `HTTP ${res.status} ${res.statusText}`,\r\n      detail: data,\r\n    };\r\n    throw err;\r\n  }\r\n\r\n  return data as T;\r\n}"],"mappings":"AAAA;AACA,MAAMA,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,8BAA8B;AAQjF,SAASC,QAAQA,CAAA,EAAG;EAClB,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACtC;AAEA,OAAO,eAAeC,GAAGA,CAAIC,IAAY,EAAEC,OAAoB,GAAG,CAAC,CAAC,EAAc;EAChF,MAAMC,KAAK,GAAGN,QAAQ,CAAC,CAAC;EAExB,MAAMO,OAAO,GAAG,IAAIC,OAAO,CAACH,OAAO,CAACE,OAAO,IAAI,CAAC,CAAC,CAAC;EAClD,IAAI,CAACA,OAAO,CAACE,GAAG,CAAC,cAAc,CAAC,IAAIJ,OAAO,CAACK,IAAI,EAAE;IAChDH,OAAO,CAACI,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC;EACjD;EACA,IAAIL,KAAK,EAAEC,OAAO,CAACI,GAAG,CAAC,eAAe,EAAE,UAAUL,KAAK,EAAE,CAAC;EAE1D,MAAMM,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGjB,QAAQ,GAAGQ,IAAI,EAAE,EAAE;IAC5C,GAAGC,OAAO;IACVE;EACF,CAAC,CAAC;EAEF,MAAMO,IAAI,GAAG,MAAMF,GAAG,CAACE,IAAI,CAAC,CAAC;EAC7B,IAAIC,IAAS,GAAG,IAAI;EACpB,IAAI;IACFA,IAAI,GAAGD,IAAI,GAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,IAAI;EACvC,CAAC,CAAC,MAAM;IACNC,IAAI,GAAGD,IAAI;EACb;EAEA,IAAI,CAACF,GAAG,CAACM,EAAE,EAAE;IACX,MAAMC,GAAc,GAAG;MACrBC,MAAM,EAAER,GAAG,CAACQ,MAAM;MAClBC,OAAO,EAAGN,IAAI,KAAKA,IAAI,CAACO,MAAM,IAAIP,IAAI,CAACM,OAAO,CAAC,IAAK,QAAQT,GAAG,CAACQ,MAAM,IAAIR,GAAG,CAACW,UAAU,EAAE;MAC1FD,MAAM,EAAEP;IACV,CAAC;IACD,MAAMI,GAAG;EACX;EAEA,OAAOJ,IAAI;AACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}