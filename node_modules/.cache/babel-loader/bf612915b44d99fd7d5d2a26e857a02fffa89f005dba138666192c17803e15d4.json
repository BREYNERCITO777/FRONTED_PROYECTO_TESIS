{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROYECTO DE TESIS A\\xD1O 2026\\\\sistema-armas\\\\frontend\\\\src\\\\modules\\\\cameras\\\\ui\\\\Cameras.tsx\",\n  _s = $RefreshSig$();\nimport React, { useMemo, useState, useEffect, useCallback } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../../shared/ui/card\";\nimport { Button } from \"../../../shared/ui/button\";\nimport { Badge } from \"../../../shared/ui/badge\";\nimport { Input } from \"../../../shared/ui/input\";\nimport { Label } from \"../../../shared/ui/label\";\nimport { Switch } from \"../../../shared/ui/switch\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"../../../shared/ui/dialog\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../../shared/ui/table\";\nimport { Play, Square, Pencil, Trash2, Plus, Video, Activity, Server, ChevronLeft, ChevronRight, Eye, RefreshCw, Maximize2, Minimize2, X, AlertTriangle } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { listCameras, createCamera, updateCamera, deleteCamera, startCamera, stopCamera } from \"../../../api/cameras\";\nimport { useAuth } from \"../../../context/auth-context\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\nfunction normalizeCamera(raw) {\n  var _ref, _raw$_id, _raw$name, _raw$rtsp_url, _raw$fps_target, _raw$infer_every_n_fr, _raw$status;\n  const id = String((_ref = (_raw$_id = raw._id) !== null && _raw$_id !== void 0 ? _raw$_id : raw.id) !== null && _ref !== void 0 ? _ref : \"\");\n  const name = String((_raw$name = raw.name) !== null && _raw$name !== void 0 ? _raw$name : \"C√°mara\");\n  const rtsp_url = String((_raw$rtsp_url = raw.rtsp_url) !== null && _raw$rtsp_url !== void 0 ? _raw$rtsp_url : \"0\");\n  const enabled = raw.enabled === undefined ? true : Boolean(raw.enabled);\n  const fps_target = Number((_raw$fps_target = raw.fps_target) !== null && _raw$fps_target !== void 0 ? _raw$fps_target : 30) || 30;\n  const infer_every_n_frames = Number((_raw$infer_every_n_fr = raw.infer_every_n_frames) !== null && _raw$infer_every_n_fr !== void 0 ? _raw$infer_every_n_fr : 5) || 5;\n  const rawStatus = String((_raw$status = raw.status) !== null && _raw$status !== void 0 ? _raw$status : \"\").toUpperCase();\n  const status = rawStatus === \"RUNNING\" || rawStatus === \"STOPPED\" ? rawStatus : enabled ? \"RUNNING\" : \"STOPPED\";\n  return {\n    id,\n    name,\n    rtsp_url,\n    enabled,\n    fps_target,\n    infer_every_n_frames,\n    status\n  };\n}\nexport function Cameras() {\n  _s();\n  var _user$role, _activeVideoCamera$na;\n  const {\n    user,\n    token\n  } = useAuth();\n  const isAdmin = (user === null || user === void 0 ? void 0 : user.role) === \"admin\";\n  const [loading, setLoading] = useState(true);\n  const [cameras, setCameras] = useState([]);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isVideoModalOpen, setIsVideoModalOpen] = useState(false);\n  const [activeVideoCamera, setActiveVideoCamera] = useState(null);\n  const [editingCamera, setEditingCamera] = useState(null);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    rtsp_url: \"\",\n    enabled: true,\n    fps_target: 30,\n    infer_every_n_frames: 5\n  });\n\n  // ------- STREAM -------\n  const [streamKey, setStreamKey] = useState(Date.now());\n  const [streamError, setStreamError] = useState(null);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const getStreamUrl = useCallback(cameraId => {\n    const base = `${API_BASE}/inference/stream/${cameraId}`;\n    const qs = [];\n    if (token) qs.push(`token=${encodeURIComponent(token)}`);\n    qs.push(`t=${streamKey}`); // cache-bust\n    return `${base}?${qs.join(\"&\")}`;\n  }, [token, streamKey]);\n  async function refresh() {\n    try {\n      const data = await listCameras();\n      const normalized = Array.isArray(data) ? data.map(normalizeCamera) : [];\n      setCameras(normalized);\n    } catch (e) {\n      var _e$response;\n      console.error(\"listCameras error:\", e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudieron cargar las c√°maras\");\n    }\n  }\n  useEffect(() => {\n    (async () => {\n      setLoading(true);\n      await refresh();\n      setLoading(false);\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // PAGINACI√ìN\n  const pageSize = 5;\n  const [page, setPage] = useState(1);\n  const totalPages = Math.max(1, Math.ceil(cameras.length / pageSize));\n  useEffect(() => setPage(p => Math.min(p, totalPages)), [totalPages]);\n  const pageData = useMemo(() => {\n    const start = (page - 1) * pageSize;\n    return cameras.slice(start, start + pageSize);\n  }, [cameras, page]);\n  const canPrev = page > 1;\n  const canNext = page < totalPages;\n  const goPrev = () => setPage(p => Math.max(1, p - 1));\n  const goNext = () => setPage(p => Math.min(totalPages, p + 1));\n  const handleStartStop = async (id, currentStatus) => {\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para iniciar/detener c√°maras\");\n      return;\n    }\n    const nextStatus = currentStatus === \"RUNNING\" ? \"STOPPED\" : \"RUNNING\";\n    setCameras(prev => prev.map(cam => cam.id === id ? {\n      ...cam,\n      status: nextStatus\n    } : cam));\n    try {\n      if (currentStatus === \"RUNNING\") {\n        await stopCamera(id);\n        toast.success(\"üî¥ Detenida\");\n      } else {\n        await startCamera(id);\n        toast.success(\"üü¢ Iniciada\");\n      }\n    } catch (e) {\n      var _e$response2;\n      console.error(\"start/stop error:\", e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : _e$response2.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudo cambiar el estado\");\n      setCameras(prev => prev.map(cam => cam.id === id ? {\n        ...cam,\n        status: currentStatus\n      } : cam));\n    }\n  };\n  const handleDelete = async (id, name) => {\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para eliminar c√°maras\");\n      return;\n    }\n    const prev = cameras;\n    setCameras(p => p.filter(c => c.id !== id));\n    try {\n      await deleteCamera(id);\n      toast.success(`C√°mara \"${name}\" eliminada`);\n    } catch (e) {\n      var _e$response3;\n      console.error(\"delete error:\", e === null || e === void 0 ? void 0 : (_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : _e$response3.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudo eliminar la c√°mara\");\n      setCameras(prev);\n    }\n  };\n  const handleEdit = camera => {\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para editar c√°maras\");\n      return;\n    }\n    setEditingCamera(camera);\n    setFormData({\n      name: camera.name,\n      rtsp_url: camera.rtsp_url,\n      enabled: camera.enabled,\n      fps_target: camera.fps_target,\n      infer_every_n_frames: camera.infer_every_n_frames\n    });\n    setIsDialogOpen(true);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!isAdmin) {\n      toast.error(\"No tienes permisos para guardar c√°maras\");\n      return;\n    }\n    try {\n      if (editingCamera) {\n        await updateCamera(editingCamera.id, formData);\n        toast.success(\"C√°mara actualizada\");\n      } else {\n        await createCamera(formData);\n        toast.success(\"C√°mara creada\");\n      }\n      setIsDialogOpen(false);\n      setEditingCamera(null);\n      await refresh();\n    } catch (e) {\n      var _e$response4;\n      console.error(\"save camera error:\", e === null || e === void 0 ? void 0 : (_e$response4 = e.response) === null || _e$response4 === void 0 ? void 0 : _e$response4.status, e === null || e === void 0 ? void 0 : e.message);\n      toast.error(\"No se pudo guardar la c√°mara\");\n    }\n  };\n  const runningCameras = cameras.filter(c => c.status === \"RUNNING\").length;\n  const stoppedCameras = cameras.filter(c => c.status === \"STOPPED\").length;\n\n  // --- OPEN VIDEO MODAL ---\n  const openVideo = camera => {\n    setActiveVideoCamera(camera);\n    setStreamError(null);\n    setStreamKey(Date.now()); // nuevo stream\n    setIsFullscreen(false);\n    setIsVideoModalOpen(true);\n  };\n  const closeVideo = () => {\n    // forzar que se ‚Äúcorte‚Äù el stream del <img>\n    setStreamKey(Date.now());\n    setIsVideoModalOpen(false);\n    setActiveVideoCamera(null);\n    setStreamError(null);\n    setIsFullscreen(false);\n  };\n  const reloadStream = () => {\n    setStreamError(null);\n    setStreamKey(Date.now());\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-slate-900\",\n          children: \"Gesti\\xF3n de C\\xE1maras\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-slate-600\",\n          children: \"Monitoreo y administraci\\xF3n de dispositivos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-slate-500 mt-1\",\n          children: [\"Rol actual: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-semibold\",\n            children: (_user$role = user === null || user === void 0 ? void 0 : user.role) !== null && _user$role !== void 0 ? _user$role : \"‚Äî\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline\",\n          onClick: () => refresh(),\n          children: \"Refrescar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n          open: isDialogOpen,\n          onOpenChange: setIsDialogOpen,\n          children: [/*#__PURE__*/_jsxDEV(DialogTrigger, {\n            asChild: true,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              disabled: !isAdmin,\n              title: !isAdmin ? \"Solo admin puede crear c√°maras\" : undefined,\n              onClick: () => {\n                if (!isAdmin) return;\n                setEditingCamera(null);\n                setFormData({\n                  name: \"\",\n                  rtsp_url: \"\",\n                  enabled: true,\n                  fps_target: 30,\n                  infer_every_n_frames: 5\n                });\n              },\n              children: [/*#__PURE__*/_jsxDEV(Plus, {\n                className: \"h-5 w-5 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 17\n              }, this), \" Nueva C\\xE1mara\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n            className: \"sm:max-w-[500px]\",\n            children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n              children: /*#__PURE__*/_jsxDEV(DialogTitle, {\n                className: \"flex items-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(Video, {\n                  className: \"h-5 w-5 text-blue-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 19\n                }, this), editingCamera ? \"Editar C√°mara\" : \"Nueva C√°mara\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleSubmit,\n              className: \"space-y-4 pt-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Nombre\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  value: formData.name,\n                  onChange: e => setFormData({\n                    ...formData,\n                    name: e.target.value\n                  }),\n                  placeholder: \"Ej: Pasillo A\",\n                  required: true,\n                  disabled: !isAdmin\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 318,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"URL RTSP / Fuente\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  value: formData.rtsp_url,\n                  onChange: e => setFormData({\n                    ...formData,\n                    rtsp_url: e.target.value\n                  }),\n                  placeholder: \"0 (local) o rtsp://...\",\n                  required: true,\n                  disabled: !isAdmin\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-[11px] text-slate-500\",\n                  children: \"Nota: en servidor (Render) NO funciona webcam \\\"0\\\". Usa RTSP/IP cam.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between p-3 bg-slate-50 rounded-lg border\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Habilitar detecci\\xF3n\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Switch, {\n                  checked: formData.enabled,\n                  onCheckedChange: checked => setFormData({\n                    ...formData,\n                    enabled: checked\n                  }),\n                  disabled: !isAdmin\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-2 gap-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Label, {\n                    children: \"FPS objetivo\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 352,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Input, {\n                    type: \"number\",\n                    min: 1,\n                    max: 60,\n                    value: formData.fps_target,\n                    onChange: e => setFormData({\n                      ...formData,\n                      fps_target: Number(e.target.value)\n                    }),\n                    disabled: !isAdmin\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 353,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Label, {\n                    children: \"Infer cada N frames\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 364,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Input, {\n                    type: \"number\",\n                    min: 1,\n                    max: 60,\n                    value: formData.infer_every_n_frames,\n                    onChange: e => setFormData({\n                      ...formData,\n                      infer_every_n_frames: Number(e.target.value)\n                    }),\n                    disabled: !isAdmin\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 365,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 363,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pt-2\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"submit\",\n                  className: \"w-full\",\n                  disabled: !isAdmin,\n                  children: editingCamera ? \"Actualizar\" : \"Crear\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 379,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 378,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-4 gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(Card, {\n        className: \"border-0 shadow-sm border-l-4 border-l-emerald-500\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-bold text-slate-500\",\n                children: \"ACTIVAS\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 395,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-2xl font-bold\",\n                children: runningCameras\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Play, {\n              className: \"h-5 w-5 text-emerald-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        className: \"border-0 shadow-sm border-l-4 border-l-slate-400\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-bold text-slate-500\",\n                children: \"DETENIDAS\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-2xl font-bold\",\n                children: stoppedCameras\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 408,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Square, {\n              className: \"h-5 w-5 text-slate-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        className: \"border-0 shadow-sm border-l-4 border-l-blue-500\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-bold text-slate-500\",\n                children: \"ACTIVIDAD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-2xl font-bold\",\n                children: [cameras.length ? Math.round(runningCameras / cameras.length * 100) : 0, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 420,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Activity, {\n              className: \"h-5 w-5 text-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      className: \"border-0 shadow-sm\",\n      children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n        className: \"bg-slate-50/50 border-b\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(Server, {\n            className: \"h-4 w-4 text-slate-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CardTitle, {\n            className: \"text-sm\",\n            children: \"Listado de Dispositivos\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n        className: \"p-0\",\n        children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6 text-sm text-slate-500\",\n          children: \"Cargando c\\xE1maras...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Table, {\n            children: [/*#__PURE__*/_jsxDEV(TableHeader, {\n              children: /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"ID\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 447,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"C\\xE1mara\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 448,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  className: \"text-center\",\n                  children: \"Estado\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 449,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  className: \"text-right\",\n                  children: \"Acciones\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 450,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 445,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n              children: pageData.map(camera => /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"font-mono text-xs\",\n                  children: camera.id\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 457,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"font-semibold\",\n                  children: camera.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 458,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"text-center\",\n                  children: /*#__PURE__*/_jsxDEV(Badge, {\n                    className: camera.status === \"RUNNING\" ? \"bg-emerald-100 text-emerald-700\" : \"bg-slate-100 text-slate-600\",\n                    children: camera.status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 460,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 459,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  className: \"text-right flex justify-end gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    onClick: () => openVideo(camera),\n                    disabled: camera.status === \"STOPPED\",\n                    title: camera.status === \"STOPPED\" ? \"Inicia la c√°mara para ver stream\" : undefined,\n                    children: [/*#__PURE__*/_jsxDEV(Eye, {\n                      className: \"h-4 w-4 mr-1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 478,\n                      columnNumber: 27\n                    }, this), \" Ver\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 472,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    variant: \"outline\",\n                    onClick: () => handleStartStop(camera.id, camera.status),\n                    disabled: !isAdmin,\n                    title: !isAdmin ? \"Solo admin puede iniciar/detener\" : undefined,\n                    children: camera.status === \"RUNNING\" ? /*#__PURE__*/_jsxDEV(Square, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 489,\n                      columnNumber: 29\n                    }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 491,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 481,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    variant: \"outline\",\n                    onClick: () => handleEdit(camera),\n                    disabled: !isAdmin,\n                    title: !isAdmin ? \"Solo admin puede editar\" : undefined,\n                    children: /*#__PURE__*/_jsxDEV(Pencil, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 502,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 495,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    size: \"sm\",\n                    variant: \"outline\",\n                    className: \"text-rose-600\",\n                    onClick: () => handleDelete(camera.id, camera.name),\n                    disabled: !isAdmin,\n                    title: !isAdmin ? \"Solo admin puede eliminar\" : undefined,\n                    children: /*#__PURE__*/_jsxDEV(Trash2, {\n                      className: \"h-4 w-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 513,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 505,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 471,\n                  columnNumber: 23\n                }, this)]\n              }, camera.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 border-t flex items-center justify-between bg-slate-50/30\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-slate-500\",\n              children: [\"P\\xE1gina \", page, \" de \", totalPages]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 522,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline\",\n                size: \"sm\",\n                onClick: goPrev,\n                disabled: !canPrev,\n                children: /*#__PURE__*/_jsxDEV(ChevronLeft, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 527,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 526,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline\",\n                size: \"sm\",\n                onClick: goNext,\n                disabled: !canNext,\n                children: /*#__PURE__*/_jsxDEV(ChevronRight, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 530,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 529,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 525,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: isVideoModalOpen,\n      onOpenChange: v => v ? setIsVideoModalOpen(true) : closeVideo(),\n      children: /*#__PURE__*/_jsxDEV(DialogContent, {\n        className: isFullscreen ? \"p-0 w-[100vw] h-[100vh] max-w-none rounded-none bg-slate-950 border-slate-900\" : \"sm:max-w-5xl bg-slate-950 border-slate-800\",\n        children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n          className: isFullscreen ? \"px-4 pt-4\" : \"\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n              className: \"text-slate-100 uppercase text-xs tracking-widest\",\n              children: [\"En Vivo: \", (_activeVideoCamera$na = activeVideoCamera === null || activeVideoCamera === void 0 ? void 0 : activeVideoCamera.name) !== null && _activeVideoCamera$na !== void 0 ? _activeVideoCamera$na : \"‚Äî\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 550,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                variant: \"outline\",\n                className: \"border-slate-700 text-slate-100 hover:bg-slate-900\",\n                onClick: reloadStream,\n                children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n                  className: \"h-4 w-4 mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 561,\n                  columnNumber: 19\n                }, this), \"Recargar\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 555,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                variant: \"outline\",\n                className: \"border-slate-700 text-slate-100 hover:bg-slate-900\",\n                onClick: () => setIsFullscreen(s => !s),\n                children: isFullscreen ? /*#__PURE__*/_jsxDEV(Minimize2, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 571,\n                  columnNumber: 35\n                }, this) : /*#__PURE__*/_jsxDEV(Maximize2, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 571,\n                  columnNumber: 71\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 565,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                variant: \"outline\",\n                className: \"border-slate-700 text-slate-100 hover:bg-slate-900\",\n                onClick: closeVideo,\n                children: /*#__PURE__*/_jsxDEV(X, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 580,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 574,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 549,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 548,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: isFullscreen ? \"px-4 pb-4\" : \"\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative aspect-video bg-black rounded-xl overflow-hidden border border-slate-800\",\n            children: [streamError && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-0 flex items-center justify-center bg-black/70 z-10 p-6\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"max-w-lg text-center text-slate-100 space-y-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n                    className: \"h-5 w-5 text-amber-400\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 593,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"font-bold\",\n                    children: \"No se pudo cargar el stream\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 594,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 592,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-slate-300 break-words\",\n                  children: streamError\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 596,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center gap-2 pt-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"outline\",\n                    className: \"border-slate-700 text-slate-100 hover:bg-slate-900\",\n                    onClick: reloadStream,\n                    children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n                      className: \"h-4 w-4 mr-2\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 603,\n                      columnNumber: 25\n                    }, this), \"Reintentar\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 598,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"outline\",\n                    className: \"border-slate-700 text-slate-100 hover:bg-slate-900\",\n                    onClick: closeVideo,\n                    children: \"Cerrar\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 606,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 597,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 591,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 590,\n              columnNumber: 17\n            }, this), activeVideoCamera && /*#__PURE__*/_jsxDEV(\"img\", {\n              // fuerza reset\n              src: getStreamUrl(activeVideoCamera.id),\n              alt: \"Live\",\n              className: \"w-full h-full object-contain bg-black\",\n              onError: () => {\n                const url = getStreamUrl(activeVideoCamera.id);\n                setStreamError(`Error cargando MJPEG. Revisa: token v√°lido, c√°mara RUNNING, y que /inference/stream acepte ?token=. URL: ${url}`);\n              }\n            }, streamKey, false, {\n              fileName: _jsxFileName,\n              lineNumber: 619,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 587,\n            columnNumber: 13\n          }, this), activeVideoCamera && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-3 text-xs text-slate-300 break-all\",\n            children: [\"Stream URL: \", getStreamUrl(activeVideoCamera.id)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 635,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 586,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 270,\n    columnNumber: 5\n  }, this);\n}\n_s(Cameras, \"vZk9PHbMTrFJLrDxennWlqGhPqc=\", false, function () {\n  return [useAuth];\n});\n_c = Cameras;\nvar _c;\n$RefreshReg$(_c, \"Cameras\");","map":{"version":3,"names":["React","useMemo","useState","useEffect","useCallback","Card","CardContent","CardHeader","CardTitle","Button","Badge","Input","Label","Switch","Dialog","DialogContent","DialogHeader","DialogTitle","DialogTrigger","Table","TableBody","TableCell","TableHead","TableHeader","TableRow","Play","Square","Pencil","Trash2","Plus","Video","Activity","Server","ChevronLeft","ChevronRight","Eye","RefreshCw","Maximize2","Minimize2","X","AlertTriangle","toast","listCameras","createCamera","updateCamera","deleteCamera","startCamera","stopCamera","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","API_BASE","process","env","REACT_APP_API_BASE","normalizeCamera","raw","_ref","_raw$_id","_raw$name","_raw$rtsp_url","_raw$fps_target","_raw$infer_every_n_fr","_raw$status","id","String","_id","name","rtsp_url","enabled","undefined","Boolean","fps_target","Number","infer_every_n_frames","rawStatus","status","toUpperCase","Cameras","_s","_user$role","_activeVideoCamera$na","user","token","isAdmin","role","loading","setLoading","cameras","setCameras","isDialogOpen","setIsDialogOpen","isVideoModalOpen","setIsVideoModalOpen","activeVideoCamera","setActiveVideoCamera","editingCamera","setEditingCamera","formData","setFormData","streamKey","setStreamKey","Date","now","streamError","setStreamError","isFullscreen","setIsFullscreen","getStreamUrl","cameraId","base","qs","push","encodeURIComponent","join","refresh","data","normalized","Array","isArray","map","e","_e$response","console","error","response","message","pageSize","page","setPage","totalPages","Math","max","ceil","length","p","min","pageData","start","slice","canPrev","canNext","goPrev","goNext","handleStartStop","currentStatus","nextStatus","prev","cam","success","_e$response2","handleDelete","filter","c","_e$response3","handleEdit","camera","handleSubmit","preventDefault","_e$response4","runningCameras","stoppedCameras","openVideo","closeVideo","reloadStream","className","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","open","onOpenChange","asChild","disabled","title","onSubmit","value","onChange","target","placeholder","required","checked","onCheckedChange","type","round","size","v","s","src","alt","onError","url","_c","$RefreshReg$"],"sources":["D:/PROYECTO DE TESIS A√ëO 2026/sistema-armas/frontend/src/modules/cameras/ui/Cameras.tsx"],"sourcesContent":["import React, { useMemo, useState, useEffect, useCallback } from \"react\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../../shared/ui/card\";\r\nimport { Button } from \"../../../shared/ui/button\";\r\nimport { Badge } from \"../../../shared/ui/badge\";\r\nimport { Input } from \"../../../shared/ui/input\";\r\nimport { Label } from \"../../../shared/ui/label\";\r\nimport { Switch } from \"../../../shared/ui/switch\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"../../../shared/ui/dialog\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"../../../shared/ui/table\";\r\nimport {\r\n  Play,\r\n  Square,\r\n  Pencil,\r\n  Trash2,\r\n  Plus,\r\n  Video,\r\n  Activity,\r\n  Server,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  Eye,\r\n  RefreshCw,\r\n  Maximize2,\r\n  Minimize2,\r\n  X,\r\n  AlertTriangle,\r\n} from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\n\r\nimport {\r\n  listCameras,\r\n  createCamera,\r\n  updateCamera,\r\n  deleteCamera,\r\n  startCamera,\r\n  stopCamera,\r\n} from \"../../../api/cameras\";\r\n\r\nimport { useAuth } from \"../../../context/auth-context\";\r\n\r\ninterface Camera {\r\n  id: string;\r\n  name: string;\r\n  rtsp_url: string;\r\n  enabled: boolean;\r\n  fps_target: number;\r\n  infer_every_n_frames: number;\r\n  status: \"RUNNING\" | \"STOPPED\";\r\n}\r\n\r\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\r\n\r\nfunction normalizeCamera(raw: any): Camera {\r\n  const id = String(raw._id ?? raw.id ?? \"\");\r\n  const name = String(raw.name ?? \"C√°mara\");\r\n  const rtsp_url = String(raw.rtsp_url ?? \"0\");\r\n  const enabled = raw.enabled === undefined ? true : Boolean(raw.enabled);\r\n  const fps_target = Number(raw.fps_target ?? 30) || 30;\r\n  const infer_every_n_frames = Number(raw.infer_every_n_frames ?? 5) || 5;\r\n\r\n  const rawStatus = String(raw.status ?? \"\").toUpperCase();\r\n  const status: Camera[\"status\"] =\r\n    rawStatus === \"RUNNING\" || rawStatus === \"STOPPED\"\r\n      ? (rawStatus as Camera[\"status\"])\r\n      : enabled\r\n      ? \"RUNNING\"\r\n      : \"STOPPED\";\r\n\r\n  return { id, name, rtsp_url, enabled, fps_target, infer_every_n_frames, status };\r\n}\r\n\r\nexport function Cameras() {\r\n  const { user, token } = useAuth();\r\n  const isAdmin = user?.role === \"admin\";\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [cameras, setCameras] = useState<Camera[]>([]);\r\n\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n  const [isVideoModalOpen, setIsVideoModalOpen] = useState(false);\r\n  const [activeVideoCamera, setActiveVideoCamera] = useState<Camera | null>(null);\r\n\r\n  const [editingCamera, setEditingCamera] = useState<Camera | null>(null);\r\n\r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    rtsp_url: \"\",\r\n    enabled: true,\r\n    fps_target: 30,\r\n    infer_every_n_frames: 5,\r\n  });\r\n\r\n  // ------- STREAM -------\r\n  const [streamKey, setStreamKey] = useState<number>(Date.now());\r\n  const [streamError, setStreamError] = useState<string | null>(null);\r\n  const [isFullscreen, setIsFullscreen] = useState(false);\r\n\r\n  const getStreamUrl = useCallback(\r\n    (cameraId: string) => {\r\n      const base = `${API_BASE}/inference/stream/${cameraId}`;\r\n      const qs: string[] = [];\r\n      if (token) qs.push(`token=${encodeURIComponent(token)}`);\r\n      qs.push(`t=${streamKey}`); // cache-bust\r\n      return `${base}?${qs.join(\"&\")}`;\r\n    },\r\n    [token, streamKey]\r\n  );\r\n\r\n  async function refresh() {\r\n    try {\r\n      const data = await listCameras();\r\n      const normalized = Array.isArray(data) ? data.map(normalizeCamera) : [];\r\n      setCameras(normalized);\r\n    } catch (e: any) {\r\n      console.error(\"listCameras error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudieron cargar las c√°maras\");\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      setLoading(true);\r\n      await refresh();\r\n      setLoading(false);\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  // PAGINACI√ìN\r\n  const pageSize = 5;\r\n  const [page, setPage] = useState(1);\r\n  const totalPages = Math.max(1, Math.ceil(cameras.length / pageSize));\r\n\r\n  useEffect(() => setPage((p) => Math.min(p, totalPages)), [totalPages]);\r\n\r\n  const pageData = useMemo(() => {\r\n    const start = (page - 1) * pageSize;\r\n    return cameras.slice(start, start + pageSize);\r\n  }, [cameras, page]);\r\n\r\n  const canPrev = page > 1;\r\n  const canNext = page < totalPages;\r\n  const goPrev = () => setPage((p) => Math.max(1, p - 1));\r\n  const goNext = () => setPage((p) => Math.min(totalPages, p + 1));\r\n\r\n  const handleStartStop = async (id: string, currentStatus: Camera[\"status\"]) => {\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para iniciar/detener c√°maras\");\r\n      return;\r\n    }\r\n\r\n    const nextStatus = currentStatus === \"RUNNING\" ? \"STOPPED\" : \"RUNNING\";\r\n    setCameras((prev) => prev.map((cam) => (cam.id === id ? { ...cam, status: nextStatus } : cam)));\r\n\r\n    try {\r\n      if (currentStatus === \"RUNNING\") {\r\n        await stopCamera(id);\r\n        toast.success(\"üî¥ Detenida\");\r\n      } else {\r\n        await startCamera(id);\r\n        toast.success(\"üü¢ Iniciada\");\r\n      }\r\n    } catch (e: any) {\r\n      console.error(\"start/stop error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudo cambiar el estado\");\r\n      setCameras((prev) => prev.map((cam) => (cam.id === id ? { ...cam, status: currentStatus } : cam)));\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id: string, name: string) => {\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para eliminar c√°maras\");\r\n      return;\r\n    }\r\n\r\n    const prev = cameras;\r\n    setCameras((p) => p.filter((c) => c.id !== id));\r\n\r\n    try {\r\n      await deleteCamera(id);\r\n      toast.success(`C√°mara \"${name}\" eliminada`);\r\n    } catch (e: any) {\r\n      console.error(\"delete error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudo eliminar la c√°mara\");\r\n      setCameras(prev);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (camera: Camera) => {\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para editar c√°maras\");\r\n      return;\r\n    }\r\n\r\n    setEditingCamera(camera);\r\n    setFormData({\r\n      name: camera.name,\r\n      rtsp_url: camera.rtsp_url,\r\n      enabled: camera.enabled,\r\n      fps_target: camera.fps_target,\r\n      infer_every_n_frames: camera.infer_every_n_frames,\r\n    });\r\n    setIsDialogOpen(true);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!isAdmin) {\r\n      toast.error(\"No tienes permisos para guardar c√°maras\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (editingCamera) {\r\n        await updateCamera(editingCamera.id, formData);\r\n        toast.success(\"C√°mara actualizada\");\r\n      } else {\r\n        await createCamera(formData);\r\n        toast.success(\"C√°mara creada\");\r\n      }\r\n      setIsDialogOpen(false);\r\n      setEditingCamera(null);\r\n      await refresh();\r\n    } catch (e: any) {\r\n      console.error(\"save camera error:\", e?.response?.status, e?.message);\r\n      toast.error(\"No se pudo guardar la c√°mara\");\r\n    }\r\n  };\r\n\r\n  const runningCameras = cameras.filter((c) => c.status === \"RUNNING\").length;\r\n  const stoppedCameras = cameras.filter((c) => c.status === \"STOPPED\").length;\r\n\r\n  // --- OPEN VIDEO MODAL ---\r\n  const openVideo = (camera: Camera) => {\r\n    setActiveVideoCamera(camera);\r\n    setStreamError(null);\r\n    setStreamKey(Date.now()); // nuevo stream\r\n    setIsFullscreen(false);\r\n    setIsVideoModalOpen(true);\r\n  };\r\n\r\n  const closeVideo = () => {\r\n    // forzar que se ‚Äúcorte‚Äù el stream del <img>\r\n    setStreamKey(Date.now());\r\n    setIsVideoModalOpen(false);\r\n    setActiveVideoCamera(null);\r\n    setStreamError(null);\r\n    setIsFullscreen(false);\r\n  };\r\n\r\n  const reloadStream = () => {\r\n    setStreamError(null);\r\n    setStreamKey(Date.now());\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-5\">\r\n      {/* HEADER */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-slate-900\">Gesti√≥n de C√°maras</h1>\r\n          <p className=\"text-sm text-slate-600\">Monitoreo y administraci√≥n de dispositivos</p>\r\n          <p className=\"text-xs text-slate-500 mt-1\">\r\n            Rol actual: <span className=\"font-semibold\">{user?.role ?? \"‚Äî\"}</span>\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button variant=\"outline\" onClick={() => refresh()}>\r\n            Refrescar\r\n          </Button>\r\n\r\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n            <DialogTrigger asChild>\r\n              <Button\r\n                disabled={!isAdmin}\r\n                title={!isAdmin ? \"Solo admin puede crear c√°maras\" : undefined}\r\n                onClick={() => {\r\n                  if (!isAdmin) return;\r\n                  setEditingCamera(null);\r\n                  setFormData({\r\n                    name: \"\",\r\n                    rtsp_url: \"\",\r\n                    enabled: true,\r\n                    fps_target: 30,\r\n                    infer_every_n_frames: 5,\r\n                  });\r\n                }}\r\n              >\r\n                <Plus className=\"h-5 w-5 mr-2\" /> Nueva C√°mara\r\n              </Button>\r\n            </DialogTrigger>\r\n\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n              <DialogHeader>\r\n                <DialogTitle className=\"flex items-center gap-2\">\r\n                  <Video className=\"h-5 w-5 text-blue-600\" />\r\n                  {editingCamera ? \"Editar C√°mara\" : \"Nueva C√°mara\"}\r\n                </DialogTitle>\r\n              </DialogHeader>\r\n\r\n              <form onSubmit={handleSubmit} className=\"space-y-4 pt-2\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Nombre</Label>\r\n                  <Input\r\n                    value={formData.name}\r\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                    placeholder=\"Ej: Pasillo A\"\r\n                    required\r\n                    disabled={!isAdmin}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>URL RTSP / Fuente</Label>\r\n                  <Input\r\n                    value={formData.rtsp_url}\r\n                    onChange={(e) => setFormData({ ...formData, rtsp_url: e.target.value })}\r\n                    placeholder=\"0 (local) o rtsp://...\"\r\n                    required\r\n                    disabled={!isAdmin}\r\n                  />\r\n                  <p className=\"text-[11px] text-slate-500\">\r\n                    Nota: en servidor (Render) NO funciona webcam \"0\". Usa RTSP/IP cam.\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg border\">\r\n                  <Label>Habilitar detecci√≥n</Label>\r\n                  <Switch\r\n                    checked={formData.enabled}\r\n                    onCheckedChange={(checked) => setFormData({ ...formData, enabled: checked })}\r\n                    disabled={!isAdmin}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label>FPS objetivo</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      min={1}\r\n                      max={60}\r\n                      value={formData.fps_target}\r\n                      onChange={(e) => setFormData({ ...formData, fps_target: Number(e.target.value) })}\r\n                      disabled={!isAdmin}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Infer cada N frames</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      min={1}\r\n                      max={60}\r\n                      value={formData.infer_every_n_frames}\r\n                      onChange={(e) =>\r\n                        setFormData({ ...formData, infer_every_n_frames: Number(e.target.value) })\r\n                      }\r\n                      disabled={!isAdmin}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"pt-2\">\r\n                  <Button type=\"submit\" className=\"w-full\" disabled={!isAdmin}>\r\n                    {editingCamera ? \"Actualizar\" : \"Crear\"}\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            </DialogContent>\r\n          </Dialog>\r\n        </div>\r\n      </div>\r\n\r\n      {/* STATS */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card className=\"border-0 shadow-sm border-l-4 border-l-emerald-500\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-slate-500\">ACTIVAS</p>\r\n                <p className=\"text-2xl font-bold\">{runningCameras}</p>\r\n              </div>\r\n              <Play className=\"h-5 w-5 text-emerald-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm border-l-4 border-l-slate-400\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-slate-500\">DETENIDAS</p>\r\n                <p className=\"text-2xl font-bold\">{stoppedCameras}</p>\r\n              </div>\r\n              <Square className=\"h-5 w-5 text-slate-400\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"border-0 shadow-sm border-l-4 border-l-blue-500\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-slate-500\">ACTIVIDAD</p>\r\n                <p className=\"text-2xl font-bold\">\r\n                  {cameras.length ? Math.round((runningCameras / cameras.length) * 100) : 0}%\r\n                </p>\r\n              </div>\r\n              <Activity className=\"h-5 w-5 text-blue-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* TABLA */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <CardHeader className=\"bg-slate-50/50 border-b\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Server className=\"h-4 w-4 text-slate-500\" />\r\n            <CardTitle className=\"text-sm\">Listado de Dispositivos</CardTitle>\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-0\">\r\n          {loading ? (\r\n            <div className=\"p-6 text-sm text-slate-500\">Cargando c√°maras...</div>\r\n          ) : (\r\n            <>\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>ID</TableHead>\r\n                    <TableHead>C√°mara</TableHead>\r\n                    <TableHead className=\"text-center\">Estado</TableHead>\r\n                    <TableHead className=\"text-right\">Acciones</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n\r\n                <TableBody>\r\n                  {pageData.map((camera) => (\r\n                    <TableRow key={camera.id}>\r\n                      <TableCell className=\"font-mono text-xs\">{camera.id}</TableCell>\r\n                      <TableCell className=\"font-semibold\">{camera.name}</TableCell>\r\n                      <TableCell className=\"text-center\">\r\n                        <Badge\r\n                          className={\r\n                            camera.status === \"RUNNING\"\r\n                              ? \"bg-emerald-100 text-emerald-700\"\r\n                              : \"bg-slate-100 text-slate-600\"\r\n                          }\r\n                        >\r\n                          {camera.status}\r\n                        </Badge>\r\n                      </TableCell>\r\n\r\n                      <TableCell className=\"text-right flex justify-end gap-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          onClick={() => openVideo(camera)}\r\n                          disabled={camera.status === \"STOPPED\"}\r\n                          title={camera.status === \"STOPPED\" ? \"Inicia la c√°mara para ver stream\" : undefined}\r\n                        >\r\n                          <Eye className=\"h-4 w-4 mr-1\" /> Ver\r\n                        </Button>\r\n\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleStartStop(camera.id, camera.status)}\r\n                          disabled={!isAdmin}\r\n                          title={!isAdmin ? \"Solo admin puede iniciar/detener\" : undefined}\r\n                        >\r\n                          {camera.status === \"RUNNING\" ? (\r\n                            <Square className=\"h-4 w-4\" />\r\n                          ) : (\r\n                            <Play className=\"h-4 w-4\" />\r\n                          )}\r\n                        </Button>\r\n\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleEdit(camera)}\r\n                          disabled={!isAdmin}\r\n                          title={!isAdmin ? \"Solo admin puede editar\" : undefined}\r\n                        >\r\n                          <Pencil className=\"h-4 w-4\" />\r\n                        </Button>\r\n\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          className=\"text-rose-600\"\r\n                          onClick={() => handleDelete(camera.id, camera.name)}\r\n                          disabled={!isAdmin}\r\n                          title={!isAdmin ? \"Solo admin puede eliminar\" : undefined}\r\n                        >\r\n                          <Trash2 className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n\r\n              <div className=\"p-4 border-t flex items-center justify-between bg-slate-50/30\">\r\n                <span className=\"text-xs text-slate-500\">\r\n                  P√°gina {page} de {totalPages}\r\n                </span>\r\n                <div className=\"flex gap-2\">\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={goPrev} disabled={!canPrev}>\r\n                    <ChevronLeft className=\"h-4 w-4\" />\r\n                  </Button>\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={goNext} disabled={!canNext}>\r\n                    <ChevronRight className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* MODAL STREAM MEJORADO */}\r\n      <Dialog open={isVideoModalOpen} onOpenChange={(v) => (v ? setIsVideoModalOpen(true) : closeVideo())}>\r\n        <DialogContent\r\n          className={\r\n            isFullscreen\r\n              ? \"p-0 w-[100vw] h-[100vh] max-w-none rounded-none bg-slate-950 border-slate-900\"\r\n              : \"sm:max-w-5xl bg-slate-950 border-slate-800\"\r\n          }\r\n        >\r\n          <DialogHeader className={isFullscreen ? \"px-4 pt-4\" : \"\"}>\r\n            <div className=\"flex items-center justify-between gap-2\">\r\n              <DialogTitle className=\"text-slate-100 uppercase text-xs tracking-widest\">\r\n                En Vivo: {activeVideoCamera?.name ?? \"‚Äî\"}\r\n              </DialogTitle>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  className=\"border-slate-700 text-slate-100 hover:bg-slate-900\"\r\n                  onClick={reloadStream}\r\n                >\r\n                  <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                  Recargar\r\n                </Button>\r\n\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  className=\"border-slate-700 text-slate-100 hover:bg-slate-900\"\r\n                  onClick={() => setIsFullscreen((s) => !s)}\r\n                >\r\n                  {isFullscreen ? <Minimize2 className=\"h-4 w-4\" /> : <Maximize2 className=\"h-4 w-4\" />}\r\n                </Button>\r\n\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  className=\"border-slate-700 text-slate-100 hover:bg-slate-900\"\r\n                  onClick={closeVideo}\r\n                >\r\n                  <X className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </DialogHeader>\r\n\r\n          <div className={isFullscreen ? \"px-4 pb-4\" : \"\"}>\r\n            <div className=\"relative aspect-video bg-black rounded-xl overflow-hidden border border-slate-800\">\r\n              {/* Overlay error */}\r\n              {streamError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center bg-black/70 z-10 p-6\">\r\n                  <div className=\"max-w-lg text-center text-slate-100 space-y-3\">\r\n                    <div className=\"flex items-center justify-center gap-2\">\r\n                      <AlertTriangle className=\"h-5 w-5 text-amber-400\" />\r\n                      <p className=\"font-bold\">No se pudo cargar el stream</p>\r\n                    </div>\r\n                    <p className=\"text-sm text-slate-300 break-words\">{streamError}</p>\r\n                    <div className=\"flex items-center justify-center gap-2 pt-2\">\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className=\"border-slate-700 text-slate-100 hover:bg-slate-900\"\r\n                        onClick={reloadStream}\r\n                      >\r\n                        <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                        Reintentar\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className=\"border-slate-700 text-slate-100 hover:bg-slate-900\"\r\n                        onClick={closeVideo}\r\n                      >\r\n                        Cerrar\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {activeVideoCamera && (\r\n                <img\r\n                  key={streamKey} // fuerza reset\r\n                  src={getStreamUrl(activeVideoCamera.id)}\r\n                  alt=\"Live\"\r\n                  className=\"w-full h-full object-contain bg-black\"\r\n                  onError={() => {\r\n                    const url = getStreamUrl(activeVideoCamera.id);\r\n                    setStreamError(\r\n                      `Error cargando MJPEG. Revisa: token v√°lido, c√°mara RUNNING, y que /inference/stream acepte ?token=. URL: ${url}`\r\n                    );\r\n                  }}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {activeVideoCamera && (\r\n              <div className=\"mt-3 text-xs text-slate-300 break-all\">\r\n                Stream URL: {getStreamUrl(activeVideoCamera.id)}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}