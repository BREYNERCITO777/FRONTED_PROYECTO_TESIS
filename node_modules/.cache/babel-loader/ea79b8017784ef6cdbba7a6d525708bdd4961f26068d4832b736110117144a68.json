{"ast":null,"code":"// frontend/src/modules/settings/api/settingsService.ts\n\nconst API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\nfunction getToken() {\n  return localStorage.getItem(\"token\");\n}\nasync function http(url, options = {}) {\n  var _ref;\n  const token = getToken();\n  const headers = new Headers(options.headers || {});\n  if (!headers.has(\"Content-Type\") && options.body) {\n    headers.set(\"Content-Type\", \"application/json\");\n  }\n  if (token) {\n    headers.set(\"Authorization\", `Bearer ${token}`);\n  }\n  const res = await fetch(url, {\n    ...options,\n    headers\n  });\n  const text = await res.text();\n  let data = null;\n  try {\n    data = text ? JSON.parse(text) : null;\n  } catch {\n    data = text || null;\n  }\n  if (!res.ok) {\n    const msg = typeof data === \"object\" && data && \"detail\" in data && data.detail || typeof data === \"object\" && data && \"message\" in data && data.message || `HTTP ${res.status} ${res.statusText}`;\n    throw new Error(msg);\n  }\n  return (_ref = data) !== null && _ref !== void 0 ? _ref : {};\n}\nexport async function getSettings() {\n  return http(`${API_BASE}/settings`, {\n    method: \"GET\"\n  });\n}\nexport async function updateSettings(payload) {\n  return http(`${API_BASE}/settings`, {\n    method: \"PATCH\",\n    body: JSON.stringify(payload)\n  });\n}","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","getToken","localStorage","getItem","http","url","options","_ref","token","headers","Headers","has","body","set","res","fetch","text","data","JSON","parse","ok","msg","detail","message","status","statusText","Error","getSettings","method","updateSettings","payload","stringify"],"sources":["D:/PROYECTO DE TESIS AÃ‘O 2026/sistema-armas/frontend/src/modules/settings/api/settingsService.ts"],"sourcesContent":["// frontend/src/modules/settings/api/settingsService.ts\r\n\r\nconst API_BASE =\r\n  process.env.REACT_APP_API_BASE || \"http://localhost:8000/api/v1\";\r\n\r\nexport type SystemSettings = {\r\n  confidence_threshold: number;\r\n  auto_alert: boolean;\r\n  email_notifications: boolean;\r\n  sound_alerts: boolean;\r\n  save_evidence: boolean;\r\n  max_fps: number;\r\n  infer_every_n_frames: number;\r\n  updated_at?: string;\r\n};\r\n\r\ntype ApiErrorShape = { detail?: string; message?: string } | string | null;\r\n\r\nfunction getToken() {\r\n  return localStorage.getItem(\"token\");\r\n}\r\n\r\nasync function http<T>(url: string, options: RequestInit = {}): Promise<T> {\r\n  const token = getToken();\r\n\r\n  const headers = new Headers(options.headers || {});\r\n  if (!headers.has(\"Content-Type\") && options.body) {\r\n    headers.set(\"Content-Type\", \"application/json\");\r\n  }\r\n  if (token) {\r\n    headers.set(\"Authorization\", `Bearer ${token}`);\r\n  }\r\n\r\n  const res = await fetch(url, { ...options, headers });\r\n\r\n  const text = await res.text();\r\n  let data: ApiErrorShape = null;\r\n\r\n  try {\r\n    data = text ? JSON.parse(text) : null;\r\n  } catch {\r\n    data = text || null;\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const msg =\r\n      (typeof data === \"object\" && data && \"detail\" in data && (data as any).detail) ||\r\n      (typeof data === \"object\" && data && \"message\" in data && (data as any).message) ||\r\n      `HTTP ${res.status} ${res.statusText}`;\r\n    throw new Error(msg);\r\n  }\r\n\r\n  return (data as T) ?? ({} as T);\r\n}\r\n\r\nexport async function getSettings(): Promise<SystemSettings> {\r\n  return http<SystemSettings>(`${API_BASE}/settings`, { method: \"GET\" });\r\n}\r\n\r\nexport async function updateSettings(\r\n  payload: Partial<SystemSettings>\r\n): Promise<SystemSettings> {\r\n  return http<SystemSettings>(`${API_BASE}/settings`, {\r\n    method: \"PATCH\",\r\n    body: JSON.stringify(payload),\r\n  });\r\n}"],"mappings":"AAAA;;AAEA,MAAMA,QAAQ,GACZC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,8BAA8B;AAelE,SAASC,QAAQA,CAAA,EAAG;EAClB,OAAOC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACtC;AAEA,eAAeC,IAAIA,CAAIC,GAAW,EAAEC,OAAoB,GAAG,CAAC,CAAC,EAAc;EAAA,IAAAC,IAAA;EACzE,MAAMC,KAAK,GAAGP,QAAQ,CAAC,CAAC;EAExB,MAAMQ,OAAO,GAAG,IAAIC,OAAO,CAACJ,OAAO,CAACG,OAAO,IAAI,CAAC,CAAC,CAAC;EAClD,IAAI,CAACA,OAAO,CAACE,GAAG,CAAC,cAAc,CAAC,IAAIL,OAAO,CAACM,IAAI,EAAE;IAChDH,OAAO,CAACI,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC;EACjD;EACA,IAAIL,KAAK,EAAE;IACTC,OAAO,CAACI,GAAG,CAAC,eAAe,EAAE,UAAUL,KAAK,EAAE,CAAC;EACjD;EAEA,MAAMM,GAAG,GAAG,MAAMC,KAAK,CAACV,GAAG,EAAE;IAAE,GAAGC,OAAO;IAAEG;EAAQ,CAAC,CAAC;EAErD,MAAMO,IAAI,GAAG,MAAMF,GAAG,CAACE,IAAI,CAAC,CAAC;EAC7B,IAAIC,IAAmB,GAAG,IAAI;EAE9B,IAAI;IACFA,IAAI,GAAGD,IAAI,GAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,IAAI;EACvC,CAAC,CAAC,MAAM;IACNC,IAAI,GAAGD,IAAI,IAAI,IAAI;EACrB;EAEA,IAAI,CAACF,GAAG,CAACM,EAAE,EAAE;IACX,MAAMC,GAAG,GACN,OAAOJ,IAAI,KAAK,QAAQ,IAAIA,IAAI,IAAI,QAAQ,IAAIA,IAAI,IAAKA,IAAI,CAASK,MAAM,IAC5E,OAAOL,IAAI,KAAK,QAAQ,IAAIA,IAAI,IAAI,SAAS,IAAIA,IAAI,IAAKA,IAAI,CAASM,OAAQ,IAChF,QAAQT,GAAG,CAACU,MAAM,IAAIV,GAAG,CAACW,UAAU,EAAE;IACxC,MAAM,IAAIC,KAAK,CAACL,GAAG,CAAC;EACtB;EAEA,QAAAd,IAAA,GAAQU,IAAI,cAAAV,IAAA,cAAAA,IAAA,GAAW,CAAC,CAAC;AAC3B;AAEA,OAAO,eAAeoB,WAAWA,CAAA,EAA4B;EAC3D,OAAOvB,IAAI,CAAiB,GAAGP,QAAQ,WAAW,EAAE;IAAE+B,MAAM,EAAE;EAAM,CAAC,CAAC;AACxE;AAEA,OAAO,eAAeC,cAAcA,CAClCC,OAAgC,EACP;EACzB,OAAO1B,IAAI,CAAiB,GAAGP,QAAQ,WAAW,EAAE;IAClD+B,MAAM,EAAE,OAAO;IACfhB,IAAI,EAAEM,IAAI,CAACa,SAAS,CAACD,OAAO;EAC9B,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}